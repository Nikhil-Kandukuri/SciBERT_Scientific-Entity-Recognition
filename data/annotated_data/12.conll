-DOCSTART- -X- O
Integrating -X- _ O
Semantics -X- _ O
and -X- _ O
Neighborhood -X- _ O
Information -X- _ O
with -X- _ O
Graph -X- _ B-MethodName
- -X- _ I-MethodName
Driven -X- _ I-MethodName
Generative -X- _ I-MethodName
Models -X- _ I-MethodName
for -X- _ O
Document -X- _ B-TaskName
Retrieval -X- _ I-TaskName

With -X- _ O
the -X- _ O
need -X- _ O
of -X- _ O
fast -X- _ O
retrieval -X- _ O
speed -X- _ O
and -X- _ O
small -X- _ O
memory -X- _ O
footprint -X- _ O
, -X- _ O
document -X- _ O
hashing -X- _ O
has -X- _ O
been -X- _ O
playing -X- _ O
a -X- _ O
crucial -X- _ O
role -X- _ O
in -X- _ O
large -X- _ O
- -X- _ O
scale -X- _ O
information -X- _ B-TaskName
retrieval -X- _ I-TaskName
. -X- _ O
To -X- _ O
generate -X- _ O
high -X- _ O
- -X- _ O
quality -X- _ O
hashing -X- _ O
code -X- _ O
, -X- _ O
both -X- _ O
semantics -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
are -X- _ O
crucial -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
most -X- _ O
existing -X- _ O
methods -X- _ O
leverage -X- _ O
only -X- _ O
one -X- _ O
of -X- _ O
them -X- _ O
or -X- _ O
simply -X- _ O
combine -X- _ O
them -X- _ O
via -X- _ O
some -X- _ O
intuitive -X- _ O
criteria -X- _ O
, -X- _ O
lacking -X- _ O
a -X- _ O
theoretical -X- _ O
principle -X- _ O
to -X- _ O
guide -X- _ O
the -X- _ O
integration -X- _ O
process -X- _ O
. -X- _ O
In -X- _ O
this -X- _ O
paper -X- _ O
, -X- _ O
we -X- _ O
encode -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
with -X- _ O
a -X- _ O
graph -X- _ O
- -X- _ O
induced -X- _ O
Gaussian -X- _ O
distribution -X- _ O
, -X- _ O
and -X- _ O
propose -X- _ O
to -X- _ O
integrate -X- _ O
the -X- _ O
two -X- _ O
types -X- _ O
of -X- _ O
information -X- _ O
with -X- _ O
a -X- _ O
graph -X- _ B-MethodName
- -X- _ I-MethodName
driven -X- _ I-MethodName
generative -X- _ I-MethodName
model -X- _ I-MethodName
. -X- _ O
To -X- _ O
deal -X- _ O
with -X- _ O
the -X- _ O
complicated -X- _ O
correlations -X- _ O
among -X- _ O
documents -X- _ O
, -X- _ O
we -X- _ O
further -X- _ O
propose -X- _ O
a -X- _ O
tree -X- _ O
- -X- _ O
structured -X- _ O
approximation -X- _ O
method -X- _ O
for -X- _ O
learning -X- _ O
. -X- _ O
Under -X- _ O
the -X- _ O
approximation -X- _ O
, -X- _ O
we -X- _ O
prove -X- _ O
that -X- _ O
the -X- _ O
training -X- _ O
objective -X- _ O
can -X- _ O
be -X- _ O
decomposed -X- _ O
into -X- _ O
terms -X- _ O
involving -X- _ O
only -X- _ O
singleton -X- _ O
or -X- _ O
pairwise -X- _ O
documents -X- _ O
, -X- _ O
enabling -X- _ O
the -X- _ O
model -X- _ O
to -X- _ O
be -X- _ O
trained -X- _ O
as -X- _ O
efficiently -X- _ O
as -X- _ O
uncorrelated -X- _ O
ones -X- _ O
. -X- _ O
Extensive -X- _ O
experimental -X- _ O
results -X- _ O
on -X- _ O
three -X- _ O
benchmark -X- _ O
datasets -X- _ O
show -X- _ O
that -X- _ O
our -X- _ O
method -X- _ O
achieves -X- _ O
superior -X- _ O
performance -X- _ O
over -X- _ O
state -X- _ O
- -X- _ O
of -X- _ O
- -X- _ O
the -X- _ O
- -X- _ O
art -X- _ O
methods -X- _ O
, -X- _ O
demonstrating -X- _ O
the -X- _ O
effectiveness -X- _ O
of -X- _ O
the -X- _ O
proposed -X- _ O
model -X- _ O
for -X- _ O
simultaneously -X- _ O
preserving -X- _ O
semantic -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
. -X- _ O
1 -X- _ O

Introduction -X- _ O

Similarity -X- _ O
search -X- _ O
plays -X- _ O
a -X- _ O
pivotal -X- _ O
role -X- _ O
in -X- _ O
a -X- _ O
variety -X- _ O
of -X- _ O
tasks -X- _ O
, -X- _ O
such -X- _ O
as -X- _ O
image -X- _ O
retrieval -X- _ O
( -X- _ O
Jing -X- _ O
and -X- _ O
Baluja -X- _ O
, -X- _ O
2008 -X- _ O
; -X- _ O
Zhang -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2018 -X- _ O
) -X- _ O
, -X- _ O
plagiarism -X- _ O
detection -X- _ O
( -X- _ O
Stein -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2007 -X- _ O
) -X- _ O
and -X- _ O
recommendation -X- _ O
systems -X- _ O
( -X- _ O
Koren -X- _ O
, -X- _ O
2008 -X- _ O
) -X- _ O
. -X- _ O
If -X- _ O
the -X- _ O
search -X- _ O
is -X- _ O
carried -X- _ O
out -X- _ O
in -X- _ O
the -X- _ O
original -X- _ O
continuous -X- _ O
feature -X- _ O
space -X- _ O
directly -X- _ O
, -X- _ O
the -X- _ O
requirements -X- _ O
of -X- _ O
computation -X- _ O
and -X- _ O
storage -X- _ O
would -X- _ O
be -X- _ O
extremely -X- _ O
high -X- _ O
, -X- _ O
especially -X- _ O
for -X- _ O
large -X- _ O
- -X- _ O
scale -X- _ O
applications -X- _ O
. -X- _ O
Semantic -X- _ O
hashing -X- _ O
( -X- _ O
Salakhutdinov -X- _ O
and -X- _ O
Hinton -X- _ O
, -X- _ O
2009b -X- _ O
) -X- _ O
sidesteps -X- _ O
this -X- _ O
problem -X- _ O
by -X- _ O
learning -X- _ O
a -X- _ O
compact -X- _ O
binary -X- _ O
code -X- _ O
for -X- _ O
every -X- _ O
item -X- _ O
such -X- _ O
that -X- _ O
similar -X- _ O
items -X- _ O
can -X- _ O
be -X- _ O
efficiently -X- _ O
found -X- _ O
according -X- _ O
to -X- _ O
the -X- _ O
Hamming -X- _ B-MetricName
distance -X- _ I-MetricName
of -X- _ O
binary -X- _ O
codes -X- _ O
. -X- _ O

Unsupervised -X- _ O
semantic -X- _ O
hashing -X- _ O
aims -X- _ O
to -X- _ O
learn -X- _ O
for -X- _ O
each -X- _ O
item -X- _ O
a -X- _ O
binary -X- _ O
code -X- _ O
that -X- _ O
can -X- _ O
preserve -X- _ O
the -X- _ O
semantic -X- _ O
similarity -X- _ O
information -X- _ O
of -X- _ O
original -X- _ O
items -X- _ O
, -X- _ O
without -X- _ O
the -X- _ O
supervision -X- _ O
of -X- _ O
any -X- _ O
labels -X- _ O
. -X- _ O
Motivated -X- _ O
by -X- _ O
the -X- _ O
success -X- _ O
of -X- _ O
deep -X- _ O
generative -X- _ O
models -X- _ O
( -X- _ O
Salakhutdinov -X- _ O
and -X- _ O
Hinton -X- _ O
, -X- _ O
2009a -X- _ O
; -X- _ O
Kingma -X- _ O
and -X- _ O
Welling -X- _ O
, -X- _ O
2013 -X- _ O
; -X- _ O
Rezende -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2014 -X- _ O
) -X- _ O
in -X- _ O
unsupervised -X- _ O
representation -X- _ O
learning -X- _ O
, -X- _ O
many -X- _ O
recent -X- _ O
methods -X- _ O
approach -X- _ O
this -X- _ O
problem -X- _ O
from -X- _ O
the -X- _ O
perspective -X- _ O
of -X- _ O
deep -X- _ O
generative -X- _ O
models -X- _ O
, -X- _ O
leading -X- _ O
to -X- _ O
state -X- _ O
- -X- _ O
of -X- _ O
- -X- _ O
the -X- _ O
- -X- _ O
art -X- _ O
performance -X- _ O
on -X- _ O
benchmark -X- _ O
datasets -X- _ O
. -X- _ O
Specifically -X- _ O
, -X- _ O
these -X- _ O
methods -X- _ O
train -X- _ O
a -X- _ O
deep -X- _ O
generative -X- _ O
model -X- _ O
to -X- _ O
model -X- _ O
the -X- _ O
underlying -X- _ O
documents -X- _ O
and -X- _ O
then -X- _ O
use -X- _ O
the -X- _ O
trained -X- _ O
generative -X- _ O
model -X- _ O
to -X- _ O
extract -X- _ O
continuous -X- _ O
or -X- _ O
binary -X- _ O
representations -X- _ O
from -X- _ O
the -X- _ O
original -X- _ O
documents -X- _ O
( -X- _ O
Chaidaroon -X- _ O
and -X- _ O
Fang -X- _ O
, -X- _ O
2017 -X- _ O
; -X- _ O
Shen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2018 -X- _ O
; -X- _ O
Dong -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2019 -X- _ O
; -X- _ O
Zheng -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2020 -X- _ O
) -X- _ O
. -X- _ O
The -X- _ O
basic -X- _ O
principle -X- _ O
behind -X- _ O
these -X- _ O
generative -X- _ O
hashing -X- _ O
methods -X- _ O
is -X- _ O
to -X- _ O
have -X- _ O
the -X- _ O
hash -X- _ O
codes -X- _ O
retaining -X- _ O
as -X- _ O
much -X- _ O
semantics -X- _ O
information -X- _ O
of -X- _ O
original -X- _ O
documents -X- _ O
as -X- _ O
possible -X- _ O
so -X- _ O
that -X- _ O
semantically -X- _ O
similar -X- _ O
documents -X- _ O
are -X- _ O
more -X- _ O
likely -X- _ O
to -X- _ O
yield -X- _ O
similar -X- _ O
codes -X- _ O
. -X- _ O

In -X- _ O
addition -X- _ O
to -X- _ O
semantics -X- _ O
information -X- _ O
, -X- _ O
it -X- _ O
is -X- _ O
widely -X- _ O
observed -X- _ O
that -X- _ O
neighborhood -X- _ O
information -X- _ O
among -X- _ O
the -X- _ O
documents -X- _ O
is -X- _ O
also -X- _ O
useful -X- _ O
to -X- _ O
generate -X- _ O
high -X- _ O
- -X- _ O
quality -X- _ O
hash -X- _ O
codes -X- _ O
. -X- _ O
By -X- _ O
constructing -X- _ O
an -X- _ O
adjacency -X- _ O
matrix -X- _ O
from -X- _ O
the -X- _ O
raw -X- _ O
features -X- _ O
of -X- _ O
documents -X- _ O
, -X- _ O
neighborbased -X- _ O
methods -X- _ O
seek -X- _ O
to -X- _ O
preserve -X- _ O
the -X- _ O
information -X- _ O
in -X- _ O
the -X- _ O
constructed -X- _ O
adjacency -X- _ O
matrix -X- _ O
, -X- _ O
such -X- _ O
as -X- _ O
the -X- _ O
locality -X- _ O
- -X- _ O
preserving -X- _ O
hashing -X- _ O
( -X- _ O
He -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2004 -X- _ O
; -X- _ O
Zhao -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2014 -X- _ O
) -X- _ O
, -X- _ O
spectral -X- _ O
hashing -X- _ O
( -X- _ O
Weiss -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2009 -X- _ O
; -X- _ O
Li -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2012 -X- _ O
) -X- _ O
, -X- _ O
and -X- _ O
etc -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
since -X- _ O
the -X- _ O
groundtruth -X- _ O
neighborhood -X- _ O
information -X- _ O
is -X- _ O
not -X- _ O
available -X- _ O
and -X- _ O
the -X- _ O
constructed -X- _ O
one -X- _ O
is -X- _ O
neither -X- _ O
accurate -X- _ O
nor -X- _ O
complete -X- _ O
, -X- _ O
neighbor -X- _ O
- -X- _ O
based -X- _ O
methods -X- _ O
alone -X- _ O
do -X- _ O
not -X- _ O
perform -X- _ O
as -X- _ O
well -X- _ O
as -X- _ O
the -X- _ O
semantics -X- _ O
- -X- _ O
based -X- _ O
ones -X- _ O
. -X- _ O
Despite -X- _ O
both -X- _ O
semantics -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
are -X- _ O
derived -X- _ O
from -X- _ O
the -X- _ O
original -X- _ O
documents -X- _ O
, -X- _ O
different -X- _ O
aspects -X- _ O
are -X- _ O
emphasized -X- _ O
in -X- _ O
them -X- _ O
. -X- _ O
Thus -X- _ O
, -X- _ O
to -X- _ O
obtain -X- _ O
higher -X- _ O
- -X- _ O
quality -X- _ O
hash -X- _ O
codes -X- _ O
, -X- _ O
it -X- _ O
has -X- _ O
been -X- _ O
proposed -X- _ O
to -X- _ O
incorporate -X- _ O
the -X- _ O
constructed -X- _ O
neighborhood -X- _ O
information -X- _ O
into -X- _ O
semantics -X- _ O
- -X- _ O
based -X- _ O
methods -X- _ O
. -X- _ O
For -X- _ O
examples -X- _ O
, -X- _ O
Chaidaroon -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
( -X- _ O
2018 -X- _ O
) -X- _ O
and -X- _ O
Hansen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
( -X- _ O
2020 -X- _ O
) -X- _ O
require -X- _ O
the -X- _ O
hash -X- _ O
codes -X- _ O
can -X- _ O
reconstruct -X- _ O
neighboring -X- _ O
documents -X- _ O
, -X- _ O
in -X- _ O
addition -X- _ O
to -X- _ O
the -X- _ O
original -X- _ O
input -X- _ O
. -X- _ O
Other -X- _ O
works -X- _ O
Hansen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2019 -X- _ O
) -X- _ O
use -X- _ O
an -X- _ O
extra -X- _ O
loss -X- _ O
term -X- _ O
, -X- _ O
derived -X- _ O
from -X- _ O
the -X- _ O
approximate -X- _ O
neighborhood -X- _ O
information -X- _ O
, -X- _ O
to -X- _ O
encourage -X- _ O
similar -X- _ O
documents -X- _ O
to -X- _ O
produce -X- _ O
similar -X- _ O
codes -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
all -X- _ O
of -X- _ O
the -X- _ O
aforementioned -X- _ O
methods -X- _ O
exploit -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
by -X- _ O
using -X- _ O
it -X- _ O
to -X- _ O
design -X- _ O
different -X- _ O
kinds -X- _ O
of -X- _ O
regularizers -X- _ O
to -X- _ O
the -X- _ O
original -X- _ O
semanticsbased -X- _ O
models -X- _ O
, -X- _ O
lacking -X- _ O
a -X- _ O
basic -X- _ O
principle -X- _ O
to -X- _ O
unify -X- _ O
and -X- _ O
leverage -X- _ O
them -X- _ O
under -X- _ O
one -X- _ O
framework -X- _ O
. -X- _ O

To -X- _ O
fully -X- _ O
exploit -X- _ O
the -X- _ O
two -X- _ O
types -X- _ O
of -X- _ O
information -X- _ O
, -X- _ O
in -X- _ O
this -X- _ O
paper -X- _ O
, -X- _ O
we -X- _ O
propose -X- _ O
a -X- _ O
hashing -X- _ O
method -X- _ O
that -X- _ O
unifies -X- _ O
the -X- _ O
semantics -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
with -X- _ O
the -X- _ O
graph -X- _ O
- -X- _ O
driven -X- _ O
generative -X- _ O
models -X- _ O
. -X- _ O
Specifically -X- _ O
, -X- _ O
we -X- _ O
first -X- _ O
encode -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
with -X- _ O
a -X- _ O
multivariate -X- _ O
Gaussian -X- _ O
distribution -X- _ O
. -X- _ O
With -X- _ O
this -X- _ O
Gaussian -X- _ O
distribution -X- _ O
as -X- _ O
a -X- _ O
prior -X- _ O
in -X- _ O
a -X- _ O
generative -X- _ O
model -X- _ O
, -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
can -X- _ O
be -X- _ O
naturally -X- _ O
incorporated -X- _ O
into -X- _ O
the -X- _ O
semantics -X- _ O
- -X- _ O
based -X- _ O
hashing -X- _ O
model -X- _ O
. -X- _ O
Despite -X- _ O
the -X- _ O
simplicity -X- _ O
of -X- _ O
the -X- _ O
modeling -X- _ O
, -X- _ O
the -X- _ O
correlation -X- _ B-MetricName
introduced -X- _ O
by -X- _ O
the -X- _ O
neighbor -X- _ O
- -X- _ O
encoded -X- _ O
prior -X- _ O
poses -X- _ O
a -X- _ O
significant -X- _ O
challenge -X- _ O
to -X- _ O
the -X- _ O
training -X- _ O
since -X- _ O
it -X- _ O
invalidates -X- _ O
the -X- _ O
widely -X- _ O
used -X- _ O
identical -X- _ O
- -X- _ O
andindependent -X- _ O
- -X- _ O
distributed -X- _ O
( -X- _ O
i.i.d -X- _ O
. -X- _ O
) -X- _ O
assumption -X- _ O
, -X- _ O
making -X- _ O
all -X- _ O
documents -X- _ O
correlated -X- _ O
. -X- _ O
To -X- _ O
address -X- _ O
this -X- _ O
issue -X- _ O
, -X- _ O
we -X- _ O
propose -X- _ O
to -X- _ O
use -X- _ O
a -X- _ O
tree -X- _ O
- -X- _ O
structured -X- _ O
distribution -X- _ O
to -X- _ O
capture -X- _ O
as -X- _ O
much -X- _ O
as -X- _ O
possible -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
. -X- _ O
We -X- _ O
prove -X- _ O
that -X- _ O
under -X- _ O
the -X- _ O
tree -X- _ O
approximation -X- _ O
, -X- _ O
the -X- _ O
evidence -X- _ B-MetricName
lower -X- _ I-MetricName
bound -X- _ I-MetricName
( -X- _ O
ELBO -X- _ B-MetricName
) -X- _ O
can -X- _ O
be -X- _ O
decomposed -X- _ O
into -X- _ O
terms -X- _ O
involving -X- _ O
only -X- _ O
singleton -X- _ O
and -X- _ O
pairwise -X- _ O
documents -X- _ O
, -X- _ O
enabling -X- _ O
the -X- _ O
model -X- _ O
to -X- _ O
be -X- _ O
trained -X- _ O
as -X- _ O
efficiently -X- _ O
as -X- _ O
the -X- _ O
models -X- _ O
without -X- _ O
considering -X- _ O
the -X- _ O
document -X- _ O
correlations -X- _ O
. -X- _ O
To -X- _ O
capture -X- _ O
more -X- _ O
neighborhood -X- _ O
information -X- _ O
, -X- _ O
a -X- _ O
more -X- _ O
accurate -X- _ O
approximation -X- _ O
by -X- _ O
using -X- _ O
multiple -X- _ O
trees -X- _ O
is -X- _ O
also -X- _ O
developed -X- _ O
. -X- _ O
Extensive -X- _ O
experimental -X- _ O
results -X- _ O
on -X- _ O
three -X- _ O
public -X- _ O
datasets -X- _ O
demonstrate -X- _ O
that -X- _ O
the -X- _ O
proposed -X- _ O
method -X- _ O
can -X- _ O
outperform -X- _ O
state -X- _ O
- -X- _ O
of -X- _ O
- -X- _ O
the -X- _ O
- -X- _ O
art -X- _ O
methods -X- _ O
, -X- _ O
indicating -X- _ O
the -X- _ O
effectiveness -X- _ O
of -X- _ O
the -X- _ O
proposed -X- _ O
framework -X- _ O
in -X- _ O
unifying -X- _ O
the -X- _ O
semantic -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
for -X- _ O
document -X- _ O
hashing -X- _ O
. -X- _ O

Preliminaries -X- _ O

Semantics -X- _ O
- -X- _ O
Based -X- _ O
Hashing -X- _ O
Due -X- _ O
to -X- _ O
the -X- _ O
similarities -X- _ O
among -X- _ O
the -X- _ O
underlying -X- _ O
ideas -X- _ O
of -X- _ O
these -X- _ O
methods -X- _ O
, -X- _ O
we -X- _ O
take -X- _ O
the -X- _ O
variational -X- _ B-MethodName
deep -X- _ I-MethodName
semantic -X- _ I-MethodName
hashing -X- _ I-MethodName
( -X- _ O
VDSH -X- _ B-MethodName
) -X- _ O
( -X- _ O
Chaidaroon -X- _ O
and -X- _ O
Fang -X- _ O
, -X- _ O
2017 -X- _ O
) -X- _ O
as -X- _ O
an -X- _ O
example -X- _ O
to -X- _ O
illustrate -X- _ O
their -X- _ O
working -X- _ O
flow -X- _ O
. -X- _ O
Given -X- _ O
a -X- _ O
document -X- _ O
x -X- _ O
{ -X- _ O
w -X- _ O
j -X- _ O
} -X- _ O
|x| -X- _ O
j=1 -X- _ O
, -X- _ O
VDSH -X- _ B-MethodName
proposes -X- _ O
to -X- _ O
model -X- _ O
a -X- _ O
document -X- _ O
by -X- _ O
a -X- _ O
generative -X- _ O
model -X- _ O
as -X- _ O

p -X- _ O
( -X- _ O
x -X- _ O
, -X- _ O
z -X- _ O
) -X- _ O
= -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x|z -X- _ O
) -X- _ O
p -X- _ O
( -X- _ O
z -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
1 -X- _ O
) -X- _ O

where -X- _ O
p -X- _ O
( -X- _ O
z -X- _ O
) -X- _ O
is -X- _ O
the -X- _ O
prior -X- _ O
distribution -X- _ O
and -X- _ O
is -X- _ O
chosen -X- _ O
to -X- _ O
be -X- _ O
the -X- _ O
standard -X- _ O
Gaussian -X- _ O
distribution -X- _ O
N -X- _ O
( -X- _ O
z -X- _ O
; -X- _ O
0 -X- _ O
, -X- _ O
I -X- _ O
d -X- _ O
) -X- _ O
, -X- _ O
with -X- _ O
I -X- _ O
d -X- _ O
denoting -X- _ O
the -X- _ O
d -X- _ O
- -X- _ O
dimensional -X- _ O
identity -X- _ O
matrix -X- _ O
; -X- _ O
and -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x|z -X- _ O
) -X- _ O
is -X- _ O
defined -X- _ O
to -X- _ O
be -X- _ O

p -X- _ O
θ -X- _ O
( -X- _ O
x|z -X- _ O
) -X- _ O
= -X- _ O
w -X- _ O
i -X- _ O
∈x -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
w -X- _ O
i -X- _ O
|z -X- _ O
) -X- _ O
( -X- _ O
2 -X- _ O
) -X- _ O
with -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
w -X- _ O
i -X- _ O
|z -X- _ O
) -X- _ O
exp -X- _ O
( -X- _ O
z -X- _ O
T -X- _ O
Ew -X- _ O
i -X- _ O
+ -X- _ O
b -X- _ O
i -X- _ O
) -X- _ O
|V -X- _ O
| -X- _ O
j=1 -X- _ O
exp -X- _ O
( -X- _ O
z -X- _ O
T -X- _ O
Ew -X- _ O
j -X- _ O
+ -X- _ O
b -X- _ O
j -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
3 -X- _ O
) -X- _ O

in -X- _ O
which -X- _ O
w -X- _ O
j -X- _ O
denotes -X- _ O
the -X- _ O
|V -X- _ O
|-dimensional -X- _ O
one -X- _ O
- -X- _ O
hot -X- _ O
representation -X- _ O
of -X- _ O
the -X- _ O
j -X- _ O
- -X- _ O
th -X- _ O
word -X- _ O
, -X- _ O
with -X- _ O
|x| -X- _ O
and -X- _ O
|V -X- _ O
| -X- _ O
denoting -X- _ O
the -X- _ O
document -X- _ O
and -X- _ O
vocabulary -X- _ O
size -X- _ O
, -X- _ O
respectively -X- _ O
; -X- _ O
and -X- _ O
E -X- _ O
∈ -X- _ O
R -X- _ O
d×|V -X- _ O
| -X- _ O
represents -X- _ O
the -X- _ O
learnable -X- _ O
embedding -X- _ O
matrix -X- _ O
. -X- _ O
For -X- _ O
a -X- _ O
corpus -X- _ O
containing -X- _ O
N -X- _ O
documents -X- _ O
X -X- _ O
= -X- _ O
{ -X- _ O
x -X- _ O
1 -X- _ O
, -X- _ O
x -X- _ O
2 -X- _ O
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
x -X- _ O
N -X- _ O
} -X- _ O
, -X- _ O
due -X- _ O
to -X- _ O
the -X- _ O
i.i.d -X- _ O
. -X- _ O
assumption -X- _ O
for -X- _ O
documents -X- _ O
, -X- _ O
it -X- _ O
is -X- _ O
modelled -X- _ O
by -X- _ O
simply -X- _ O
multiplying -X- _ O
individual -X- _ O
document -X- _ O
models -X- _ O
as -X- _ O

p -X- _ O
( -X- _ O
X -X- _ O
, -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
k=1 -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x -X- _ O
k -X- _ O
|z -X- _ O
k -X- _ O
) -X- _ O
p -X- _ O
( -X- _ O
z -X- _ O
k -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
4 -X- _ O
) -X- _ O

where -X- _ O
Z -X- _ O
[ -X- _ O
z -X- _ O
1 -X- _ O
; -X- _ O
z -X- _ O
2 -X- _ O
; -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
; -X- _ O
z -X- _ O
N -X- _ O
] -X- _ O
denotes -X- _ O
a -X- _ O
long -X- _ O
vector -X- _ O
obtained -X- _ O
by -X- _ O
concatenating -X- _ O
the -X- _ O
individual -X- _ O
vectors -X- _ O
z -X- _ O
i -X- _ O
. -X- _ O
The -X- _ O
model -X- _ O
is -X- _ O
trained -X- _ O
by -X- _ O
optimizing -X- _ O
the -X- _ O
evidence -X- _ B-MetricName
lower -X- _ I-MetricName
bound -X- _ I-MetricName
( -X- _ O
ELBO -X- _ B-MetricValue
) -X- _ O
of -X- _ O
the -X- _ O
log -X- _ B-MetricName
- -X- _ I-MetricName
likelihood -X- _ I-MetricName
function -X- _ O
log -X- _ O
p -X- _ O
( -X- _ O
X -X- _ O
) -X- _ O
. -X- _ O
After -X- _ O
training -X- _ O
, -X- _ O
outputs -X- _ O
from -X- _ O
the -X- _ O
trained -X- _ O
encoder -X- _ O
are -X- _ O
used -X- _ O
as -X- _ O
documents -X- _ O
' -X- _ O
representations -X- _ O
, -X- _ O
from -X- _ O
which -X- _ O
binary -X- _ O
hash -X- _ O
codes -X- _ O
can -X- _ O
be -X- _ O
obtained -X- _ O
by -X- _ O
thresholding -X- _ O
the -X- _ O
real -X- _ O
- -X- _ O
valued -X- _ O
representations -X- _ O
. -X- _ O

Neighborhood -X- _ O
Information -X- _ O

The -X- _ O
ground -X- _ O
- -X- _ O
truth -X- _ O
semantic -X- _ O
similarity -X- _ O
information -X- _ O
is -X- _ O
not -X- _ O
available -X- _ O
for -X- _ O
the -X- _ O
unsupervised -X- _ O
hashing -X- _ O
task -X- _ O
in -X- _ O
practice -X- _ O
. -X- _ O
To -X- _ O
leverage -X- _ O
this -X- _ O
information -X- _ O
, -X- _ O
an -X- _ O
affinity -X- _ O
N -X- _ O
× -X- _ O
N -X- _ O
matrix -X- _ O
A -X- _ O
is -X- _ O
generally -X- _ O
constructed -X- _ O
from -X- _ O
the -X- _ O
raw -X- _ O
features -X- _ O
( -X- _ O
e.g. -X- _ O
, -X- _ O
the -X- _ O
TFIDF -X- _ O
) -X- _ O
of -X- _ O
original -X- _ O
documents -X- _ O
. -X- _ O
For -X- _ O
instances -X- _ O
, -X- _ O
we -X- _ O
can -X- _ O
construct -X- _ O
the -X- _ O
matrix -X- _ O
as -X- _ O

a -X- _ O
ij -X- _ O
= -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
e -X- _ O
− -X- _ O
|| -X- _ O
x -X- _ O
i -X- _ O
−x -X- _ O
j -X- _ O
|| -X- _ O
2 -X- _ O
σ -X- _ O
, -X- _ O
x -X- _ O
i -X- _ O
∈ -X- _ O
N -X- _ O
k -X- _ O
( -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
0 -X- _ O
, -X- _ O
otherwise -X- _ O
( -X- _ O
5 -X- _ O
) -X- _ O

where -X- _ O
a -X- _ O
ij -X- _ O
denotes -X- _ O
the -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
-th -X- _ O
element -X- _ O
of -X- _ O
A -X- _ O
; -X- _ O
and -X- _ O
N -X- _ O
k -X- _ O
( -X- _ O
x -X- _ O
) -X- _ O
denotes -X- _ O
the -X- _ O
k -X- _ O
- -X- _ O
nearest -X- _ O
neighbors -X- _ O
of -X- _ O
document -X- _ O
x. -X- _ O
Given -X- _ O
the -X- _ O
affinity -X- _ O
matrix -X- _ O
A -X- _ O
, -X- _ O
some -X- _ O
methods -X- _ O
have -X- _ O
been -X- _ O
proposed -X- _ O
to -X- _ O
incorporate -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
into -X- _ O
the -X- _ O
semantics -X- _ O
- -X- _ O
based -X- _ O
hashing -X- _ O
models -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
as -X- _ O
discussed -X- _ O
above -X- _ O
, -X- _ O
these -X- _ O
methods -X- _ O
generally -X- _ O
leverage -X- _ O
the -X- _ O
information -X- _ O
based -X- _ O
on -X- _ O
some -X- _ O
intuitive -X- _ O
criteria -X- _ O
, -X- _ O
lacking -X- _ O
theoretical -X- _ O
supports -X- _ O
behind -X- _ O
them -X- _ O
. -X- _ O

A -X- _ O
Hashing -X- _ O
Framework -X- _ O
with -X- _ O
Unified -X- _ O
Semantics -X- _ O
- -X- _ O
Neighborhood -X- _ O
Information -X- _ O

In -X- _ O
this -X- _ O
section -X- _ O
, -X- _ O
we -X- _ O
present -X- _ O
a -X- _ O
more -X- _ O
effective -X- _ O
framework -X- _ O
to -X- _ O
unify -X- _ O
the -X- _ O
semantic -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
for -X- _ O
the -X- _ O
task -X- _ O
of -X- _ O
document -X- _ O
hashing -X- _ O
. -X- _ O

Reformulating -X- _ O
the -X- _ O
VDSH -X- _ B-MethodName

To -X- _ O
introduce -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
into -X- _ O
the -X- _ O
semantics -X- _ O
- -X- _ O
based -X- _ O
hashing -X- _ O
models -X- _ O
, -X- _ O
we -X- _ O
first -X- _ O
rewrite -X- _ O
the -X- _ O
VDSH -X- _ B-MethodName
model -X- _ O
into -X- _ O
a -X- _ O
compact -X- _ O
form -X- _ O
as -X- _ O

p -X- _ O
( -X- _ O
X -X- _ O
, -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
X|Z -X- _ O
) -X- _ O
p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
6 -X- _ O
) -X- _ O

where -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
X|Z -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
k=1 -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x -X- _ O
k -X- _ O
|z -X- _ O
k -X- _ O
) -X- _ O
; -X- _ O
and -X- _ O
the -X- _ O
prior -X- _ O
p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
k=1 -X- _ O
p -X- _ O
( -X- _ O
z -X- _ O
k -X- _ O
) -X- _ O
, -X- _ O
which -X- _ O
can -X- _ O
be -X- _ O
shown -X- _ O
to -X- _ O
be -X- _ O

p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
( -X- _ O
Z -X- _ O
; -X- _ O
0 -X- _ O
, -X- _ O
I -X- _ O
N -X- _ O
⊗ -X- _ O
I -X- _ O
d -X- _ O
) -X- _ O
. -X- _ O
( -X- _ O
7 -X- _ O
) -X- _ O

Here -X- _ O
, -X- _ O
⊗ -X- _ O
denotes -X- _ O
the -X- _ O
Kronecker -X- _ O
product -X- _ O
and -X- _ O
the -X- _ O
subscript -X- _ O
I -X- _ O
indicates -X- _ O
independence -X- _ O
among -X- _ O
z -X- _ O
k -X- _ O
. -X- _ O
The -X- _ O
ELBO -X- _ B-MetricName
of -X- _ O
this -X- _ O
model -X- _ O
can -X- _ O
be -X- _ O
expressed -X- _ O
as -X- _ O

L= -X- _ O
E -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
[ -X- _ O
log -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
X|Z -X- _ O
) -X- _ O
] -X- _ O
L -X- _ O
1 -X- _ O
−KL -X- _ O
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
||p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
) -X- _ O
L -X- _ O
2 -X- _ O

where -X- _ O
KL -X- _ B-MetricName
( -X- _ O
• -X- _ O
) -X- _ O
denotes -X- _ O
the -X- _ O
Kullback -X- _ B-MetricName
- -X- _ I-MetricName
Leibler -X- _ I-MetricName
( -X- _ I-MetricName
KL -X- _ I-MetricName
) -X- _ I-MetricName
divergence -X- _ I-MetricName
. -X- _ O
By -X- _ O
restricting -X- _ O
the -X- _ O
posterior -X- _ O
to -X- _ O
independent -X- _ O
Gaussian -X- _ O
form -X- _ O

q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
k=1 -X- _ O
N -X- _ O
z -X- _ O
k -X- _ O
; -X- _ O
µ -X- _ O
k -X- _ O
, -X- _ O
diag -X- _ O
( -X- _ O
σ -X- _ O
2 -X- _ O
k -X- _ O
) -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
k -X- _ O
|x -X- _ O
k -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
8 -X- _ O
) -X- _ O

the -X- _ O
L -X- _ O
1 -X- _ O
can -X- _ O
be -X- _ O
handled -X- _ O
using -X- _ O
the -X- _ O
reparameterization -X- _ O
trick -X- _ O
. -X- _ O
Thanks -X- _ O
to -X- _ O
the -X- _ O
factorized -X- _ O
forms -X- _ O
assumed -X- _ O
in -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
and -X- _ O
p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
, -X- _ O
the -X- _ O
L -X- _ O
2 -X- _ O
term -X- _ O
can -X- _ O
also -X- _ O
be -X- _ O
expressed -X- _ O
analytically -X- _ O
and -X- _ O
evaluated -X- _ O
efficiently -X- _ O
. -X- _ O

Injecting -X- _ O
the -X- _ O
Neighborhood -X- _ O
Information -X- _ O

Given -X- _ O
an -X- _ O
affinity -X- _ O
matrix -X- _ O
A -X- _ O
, -X- _ O
the -X- _ O
covariance -X- _ O
matrix -X- _ O
I -X- _ O
N -X- _ O
+ -X- _ O
λA -X- _ B-HyperparameterName
can -X- _ O
be -X- _ O
used -X- _ O
to -X- _ O
reveal -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
of -X- _ O
documents -X- _ O
, -X- _ O
where -X- _ O
the -X- _ O
hyperparameter -X- _ O
λ -X- _ B-HyperparameterName
∈ -X- _ O
[ -X- _ O
0 -X- _ B-HyperparameterValue
, -X- _ O
1 -X- _ B-HyperparameterValue
) -X- _ O
is -X- _ O
used -X- _ O
to -X- _ O
control -X- _ O
the -X- _ O
overall -X- _ O
correlation -X- _ O
strength -X- _ O
. -X- _ O
If -X- _ O
two -X- _ O
documents -X- _ O
are -X- _ O
neighboring -X- _ O
, -X- _ O
then -X- _ O
the -X- _ O
corresponding -X- _ O
correlation -X- _ O
value -X- _ O
in -X- _ O
I -X- _ O
N -X- _ O
+ -X- _ O
λA -X- _ B-HyperparameterName
will -X- _ O
be -X- _ O
large -X- _ O
; -X- _ O
otherwise -X- _ O
, -X- _ O
the -X- _ O
value -X- _ O
will -X- _ O
be -X- _ O
zero -X- _ O
. -X- _ O

To -X- _ O
have -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
reflected -X- _ O
in -X- _ O
document -X- _ O
representations -X- _ O
, -X- _ O
we -X- _ O
can -X- _ O
require -X- _ O
that -X- _ O
the -X- _ O
representations -X- _ O
z -X- _ O
i -X- _ O
are -X- _ O
drawn -X- _ O
from -X- _ O
a -X- _ O
Gaussian -X- _ O
distribution -X- _ O
of -X- _ O
the -X- _ O
form -X- _ O

p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
( -X- _ O
Z -X- _ O
; -X- _ O
0 -X- _ O
, -X- _ O
( -X- _ O
I -X- _ O
N -X- _ O
+ -X- _ O
λA -X- _ B-HyperparameterName
) -X- _ O
⊗ -X- _ O
I -X- _ O
d -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
9 -X- _ O
) -X- _ O

where -X- _ O
the -X- _ O
subscript -X- _ O
G -X- _ O
denotes -X- _ O
that -X- _ O
the -X- _ O
distribution -X- _ O
is -X- _ O
constructed -X- _ O
from -X- _ O
a -X- _ O
neighborhood -X- _ O
graph -X- _ O
. -X- _ O
To -X- _ O
see -X- _ O
why -X- _ O
the -X- _ O
representations -X- _ O
Z -X- _ O
∼ -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
have -X- _ O
already -X- _ O
reflected -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
, -X- _ O
let -X- _ O
us -X- _ O
consider -X- _ O
an -X- _ O
example -X- _ O
with -X- _ O
three -X- _ O
documents -X- _ O

{ -X- _ O
x -X- _ O
1 -X- _ O
, -X- _ O
x -X- _ O
2 -X- _ O
, -X- _ O
x -X- _ O
3 -X- _ O
} -X- _ O
, -X- _ O
in -X- _ O
which -X- _ O
x -X- _ O
1 -X- _ O
is -X- _ O
connected -X- _ O
to -X- _ O
x -X- _ O
2 -X- _ O
, -X- _ O

x -X- _ O
2 -X- _ O
is -X- _ O
connected -X- _ O
to -X- _ O
x -X- _ O
3 -X- _ O
, -X- _ O
and -X- _ O
no -X- _ O
connection -X- _ O
exists -X- _ O
between -X- _ O
x -X- _ O
1 -X- _ O
and -X- _ O
x -X- _ O
3 -X- _ O
. -X- _ O
Under -X- _ O
the -X- _ O
case -X- _ O
that -X- _ O
z -X- _ O
i -X- _ O
is -X- _ O
a -X- _ O
two -X- _ O
- -X- _ O
dimensional -X- _ O
vector -X- _ O
z -X- _ O
i -X- _ O
∈ -X- _ O
R -X- _ O
2 -X- _ O
, -X- _ O
we -X- _ O
have -X- _ O
the -X- _ O
concatenated -X- _ O
representations -X- _ O
[ -X- _ O
z -X- _ O
1 -X- _ O
; -X- _ O
z -X- _ O
2 -X- _ O
; -X- _ O
z -X- _ O
3 -X- _ O
] -X- _ O
follow -X- _ O
a -X- _ O
Gaussian -X- _ O
distribution -X- _ O
with -X- _ O
covariance -X- _ O
matrix -X- _ O
of -X- _ O

z -X- _ O
1 -X- _ O
z -X- _ O
2 -X- _ O
z -X- _ O
3 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
 -X- _ O
z -X- _ O
1 -X- _ O
1 -X- _ O
0 -X- _ O
λa -X- _ B-HyperparameterName
12 -X- _ O
0 -X- _ O
0 -X- _ O
0 -X- _ O
0 -X- _ O
1 -X- _ O
0 -X- _ O
λa -X- _ B-HyperparameterName
12 -X- _ O
0 -X- _ O
0 -X- _ O
z -X- _ O
2 -X- _ O
λa -X- _ B-HyperparameterName
21 -X- _ O
0 -X- _ O
1 -X- _ O
0 -X- _ O
λa -X- _ B-HyperparameterName
23 -X- _ O
0 -X- _ O
0 -X- _ O
λa -X- _ B-HyperparameterName
21 -X- _ O
0 -X- _ O
1 -X- _ O
0 -X- _ O
λa -X- _ B-HyperparameterName
23 -X- _ O
z -X- _ O
3 -X- _ O
0 -X- _ O
0 -X- _ O
λa -X- _ B-HyperparameterName
32 -X- _ O
0 -X- _ O
1 -X- _ O
0 -X- _ O
0 -X- _ O
0 -X- _ O
0 -X- _ O
λa -X- _ B-HyperparameterName
32 -X- _ O
0 -X- _ O
1 -X- _ O

From -X- _ O
the -X- _ O
property -X- _ O
of -X- _ O
Gaussian -X- _ O
distribution -X- _ O
, -X- _ O
it -X- _ O
can -X- _ O
be -X- _ O
known -X- _ O
that -X- _ O
z -X- _ O
1 -X- _ O
is -X- _ O
strongly -X- _ O
correlated -X- _ O
with -X- _ O
z -X- _ O
2 -X- _ O
on -X- _ O
the -X- _ O
corresponding -X- _ O
elements -X- _ O
, -X- _ O
but -X- _ O
not -X- _ O
with -X- _ O
z -X- _ O
3 -X- _ O
. -X- _ O
This -X- _ O
suggests -X- _ O
that -X- _ O
z -X- _ O
1 -X- _ O
should -X- _ O
be -X- _ O
similar -X- _ O
to -X- _ O
z -X- _ O
2 -X- _ O
, -X- _ O
but -X- _ O
different -X- _ O
from -X- _ O
z -X- _ O
3 -X- _ O
, -X- _ O
which -X- _ O
is -X- _ O
consistent -X- _ O
with -X- _ O
the -X- _ O
neighborhood -X- _ O
relation -X- _ O
that -X- _ O
x -X- _ O
1 -X- _ O
is -X- _ O
a -X- _ O
neighbor -X- _ O
of -X- _ O
x -X- _ O
2 -X- _ O
, -X- _ O
but -X- _ O
not -X- _ O
of -X- _ O
x -X- _ O
3 -X- _ O
. -X- _ O
Now -X- _ O
that -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
can -X- _ O
be -X- _ O
modeled -X- _ O
by -X- _ O
requiring -X- _ O
Z -X- _ O
being -X- _ O
drawn -X- _ O
from -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
, -X- _ O
and -X- _ O
the -X- _ O
semantic -X- _ O
information -X- _ O
can -X- _ O
be -X- _ O
reflected -X- _ O
in -X- _ O
the -X- _ O
likelihood -X- _ O
function -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
X|Z -X- _ O
) -X- _ O
. -X- _ O
The -X- _ O
two -X- _ O
types -X- _ O
of -X- _ O
information -X- _ O
can -X- _ O
be -X- _ O
taken -X- _ O
into -X- _ O
account -X- _ O
simultaneously -X- _ O
by -X- _ O
modeling -X- _ O
the -X- _ O
corpus -X- _ O
as -X- _ O

p -X- _ O
( -X- _ O
X -X- _ O
, -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
X|Z -X- _ O
) -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
. -X- _ O
( -X- _ O
10 -X- _ O

) -X- _ O

Comparing -X- _ O
to -X- _ O
the -X- _ O
VDSH -X- _ B-MethodName
model -X- _ O
in -X- _ O
( -X- _ O
6 -X- _ O
) -X- _ O
, -X- _ O
it -X- _ O
can -X- _ O
be -X- _ O
seen -X- _ O
that -X- _ O
the -X- _ O
only -X- _ O
difference -X- _ O
lies -X- _ O
in -X- _ O
the -X- _ O
employed -X- _ O
priors -X- _ O
. -X- _ O
Here -X- _ O
, -X- _ O
a -X- _ O
neighborhood -X- _ O
- -X- _ O
preserving -X- _ O
prior -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
is -X- _ O
employed -X- _ O
, -X- _ O
while -X- _ O
in -X- _ O
VDSH -X- _ B-MethodName
, -X- _ O
an -X- _ O
independent -X- _ O
prior -X- _ O
p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
is -X- _ O
used -X- _ O
. -X- _ O
Although -X- _ O
only -X- _ O
a -X- _ O
modification -X- _ O
to -X- _ O
the -X- _ O
prior -X- _ O
is -X- _ O
made -X- _ O
from -X- _ O
the -X- _ O
perspective -X- _ O
of -X- _ O
modeling -X- _ O
, -X- _ O
significant -X- _ O
challenges -X- _ O
are -X- _ O
posed -X- _ O
for -X- _ O
the -X- _ O
training -X- _ O
. -X- _ O
Specifically -X- _ O
, -X- _ O
by -X- _ O
replacing -X- _ O
p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
with -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
in -X- _ O
the -X- _ O
L -X- _ O
2 -X- _ O
of -X- _ O
L -X- _ O
, -X- _ O
it -X- _ O
can -X- _ O
be -X- _ O
shown -X- _ O
that -X- _ O
the -X- _ O
expression -X- _ O
of -X- _ O
L -X- _ O
2 -X- _ O
involves -X- _ O
the -X- _ O
matrix -X- _ O
( -X- _ O
I -X- _ O
N -X- _ O
+ -X- _ O
λA -X- _ B-HyperparameterName
) -X- _ O
⊗ -X- _ O
I -X- _ O
d -X- _ O
−1 -X- _ O
. -X- _ O
Due -X- _ O
to -X- _ O
the -X- _ O
introduced -X- _ O
dependence -X- _ O
among -X- _ O
documents -X- _ O
, -X- _ O
for -X- _ O
example -X- _ O
, -X- _ O
if -X- _ O
the -X- _ O
corpus -X- _ O
contains -X- _ O
over -X- _ O
100,000 -X- _ O
documents -X- _ O
and -X- _ O
the -X- _ O
representation -X- _ O
dimension -X- _ O
is -X- _ O
set -X- _ O
to -X- _ O
100 -X- _ O
, -X- _ O
the -X- _ O
L -X- _ O
2 -X- _ O
involves -X- _ O
the -X- _ O
inverse -X- _ O
of -X- _ O
matrices -X- _ O
with -X- _ O
dimension -X- _ O
as -X- _ O
high -X- _ O
as -X- _ O
10 -X- _ O
7 -X- _ O
, -X- _ O
which -X- _ O
is -X- _ O
computationally -X- _ O
prohibitive -X- _ O
in -X- _ O
practice -X- _ O
. -X- _ O

Training -X- _ O
with -X- _ O
Tree -X- _ O
Approximations -X- _ O

Although -X- _ O
the -X- _ O
prior -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
captures -X- _ O
the -X- _ O
full -X- _ O
neighborhood -X- _ O
information -X- _ O
, -X- _ O
its -X- _ O
induced -X- _ O
model -X- _ O
is -X- _ O
not -X- _ O
practically -X- _ O
trainable -X- _ O
. -X- _ O
In -X- _ O
this -X- _ O
section -X- _ O
, -X- _ O
to -X- _ O
facilitate -X- _ O
the -X- _ O
training -X- _ O
, -X- _ O
we -X- _ O
first -X- _ O
propose -X- _ O
to -X- _ O
use -X- _ O
a -X- _ O
tree -X- _ O
- -X- _ O
structured -X- _ O
prior -X- _ O
to -X- _ O
partially -X- _ O
capture -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
, -X- _ O
and -X- _ O
then -X- _ O
extend -X- _ O
it -X- _ O
to -X- _ O
multiple -X- _ O
- -X- _ O
tree -X- _ O
case -X- _ O
for -X- _ O
more -X- _ O
accurate -X- _ O
modeling -X- _ O
. -X- _ O

Approximating -X- _ O
the -X- _ O
Prior -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
with -X- _ O
a -X- _ O
Tree -X- _ O
- -X- _ O
Structured -X- _ O
Distribution -X- _ O

The -X- _ O
matrix -X- _ O
A -X- _ O
represents -X- _ O
a -X- _ O
graph -X- _ O
G -X- _ O
( -X- _ O
V -X- _ O
, -X- _ O
E -X- _ O
) -X- _ O
, -X- _ O
where -X- _ O
V -X- _ O
= -X- _ O
{ -X- _ O
1 -X- _ O
, -X- _ O
2 -X- _ O
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
N -X- _ O
} -X- _ O
is -X- _ O
the -X- _ O
set -X- _ O
of -X- _ O
document -X- _ O
indices -X- _ O
; -X- _ O
and -X- _ O
E -X- _ O
= -X- _ O
{ -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
|a -X- _ O
ij -X- _ O
= -X- _ O
0 -X- _ O
} -X- _ O
is -X- _ O
the -X- _ O
set -X- _ O
of -X- _ O
connections -X- _ O
between -X- _ O
documents -X- _ O
. -X- _ O
From -X- _ O
the -X- _ O
graph -X- _ O
G -X- _ O
, -X- _ O
a -X- _ O
spanning -X- _ O
tree -X- _ O
T -X- _ O
= -X- _ O
( -X- _ O
V -X- _ O
, -X- _ O
E -X- _ O
T -X- _ O
) -X- _ O
can -X- _ O
be -X- _ O
obtained -X- _ O
easily -X- _ O
, -X- _ O
where -X- _ O
E -X- _ O
T -X- _ O
denotes -X- _ O
the -X- _ O
set -X- _ O
of -X- _ O
connections -X- _ O
on -X- _ O
the -X- _ O
tree -X- _ O
. -X- _ O
2 -X- _ O
Based -X- _ O
on -X- _ O
the -X- _ O
spanning -X- _ O
tree -X- _ O
, -X- _ O
we -X- _ O
construct -X- _ O
a -X- _ O
new -X- _ O
distribution -X- _ O
as -X- _ O

p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
i∈V -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
11 -X- _ O
) -X- _ O

where -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
and -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
represent -X- _ O
one -X- _ O
- -X- _ O
and -X- _ O
two -X- _ O
- -X- _ O
variable -X- _ O
marginal -X- _ O
distributions -X- _ O
of -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
, -X- _ O
respectively -X- _ O
. -X- _ O
From -X- _ O
the -X- _ O
properties -X- _ O
of -X- _ O
Gaussian -X- _ O
distribution -X- _ O
, -X- _ O
it -X- _ O
is -X- _ O
known -X- _ O
that -X- _ O

p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
; -X- _ O
0 -X- _ O
, -X- _ O
I -X- _ O
d -X- _ O
) -X- _ O
, -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
= -X- _ O
N -X- _ O
( -X- _ O
[ -X- _ O
z -X- _ O
i -X- _ O
; -X- _ O
z -X- _ O
j -X- _ O
] -X- _ O
; -X- _ O
0 -X- _ O
, -X- _ O
( -X- _ O
I -X- _ O
2 -X- _ O
+ -X- _ O
λA -X- _ B-HyperparameterName
ij -X- _ O
) -X- _ O
⊗I -X- _ O
d -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
12 -X- _ O

) -X- _ O

where -X- _ O

A -X- _ O
ij -X- _ O
0 -X- _ O
a -X- _ O
ij -X- _ O
a -X- _ O
ji -X- _ O
0 -X- _ O
. -X- _ O
Because -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
is -X- _ O
de- -X- _ O

fined -X- _ O
on -X- _ O
a -X- _ O
tree -X- _ O
, -X- _ O
as -X- _ O
proved -X- _ O
in -X- _ O
( -X- _ O
Wainwright -X- _ O
and -X- _ O
Jordan -X- _ O
, -X- _ O
2008 -X- _ O
) -X- _ O
, -X- _ O
it -X- _ O
is -X- _ O
guaranteed -X- _ O
to -X- _ O
be -X- _ O
a -X- _ O
valid -X- _ O
probability -X- _ O
distribution -X- _ O
, -X- _ O
and -X- _ O
more -X- _ O
importantly -X- _ O
, -X- _ O
it -X- _ O
satisfies -X- _ O
the -X- _ O
following -X- _ O
two -X- _ O
relations -X- _ O

: -X- _ O
i -X- _ O
) -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
= -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
; -X- _ O
ii -X- _ O
) -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
= -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
for -X- _ O
any -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈ -X- _ O
E -X- _ O
T -X- _ O
, -X- _ O

where -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
and -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
denote -X- _ O
the -X- _ O
marginal -X- _ O
distributions -X- _ O
of -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
. -X- _ O
That -X- _ O
is -X- _ O
, -X- _ O
the -X- _ O
tree -X- _ O
- -X- _ O
structured -X- _ O
distribution -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
captures -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
reflected -X- _ O
on -X- _ O
the -X- _ O
spanning -X- _ O
tree -X- _ O
T. -X- _ O
By -X- _ O
using -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
to -X- _ O
replace -X- _ O
p -X- _ O
I -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
of -X- _ O
L -X- _ O
2 -X- _ O
, -X- _ O
it -X- _ O
can -X- _ O
be -X- _ O
shown -X- _ O
that -X- _ O
L -X- _ O
2 -X- _ O
can -X- _ O
be -X- _ O
expressed -X- _ O
as -X- _ O
the -X- _ O
summation -X- _ O
of -X- _ O
terms -X- _ O
involving -X- _ O
only -X- _ O
one -X- _ O
or -X- _ O
two -X- _ O
variables -X- _ O
, -X- _ O
which -X- _ O
can -X- _ O
be -X- _ O
handled -X- _ O
easily -X- _ O
. -X- _ O
Due -X- _ O
to -X- _ O
the -X- _ O
limitation -X- _ O
of -X- _ O
space -X- _ O
, -X- _ O
the -X- _ O
concrete -X- _ O
expression -X- _ O
for -X- _ O
the -X- _ O
lower -X- _ O
bound -X- _ O
is -X- _ O
given -X- _ O
in -X- _ O
the -X- _ O
Supplementary -X- _ O
Material -X- _ O
. -X- _ O

Imposing -X- _ O
Correlations -X- _ B-MetricName
on -X- _ O
the -X- _ O
Posterior -X- _ O

The -X- _ O
posterior -X- _ O
distribution -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
in -X- _ O
the -X- _ O
previous -X- _ O
section -X- _ O
is -X- _ O
assumed -X- _ O
to -X- _ O
be -X- _ O
in -X- _ O
independent -X- _ O
form -X- _ O
, -X- _ O
as -X- _ O
the -X- _ O
form -X- _ O
shown -X- _ O
in -X- _ O
( -X- _ O
8 -X- _ O
) -X- _ O
. -X- _ O
But -X- _ O
since -X- _ O
a -X- _ O
prior -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
considering -X- _ O
the -X- _ O
correlations -X- _ B-MetricName
among -X- _ O
documents -X- _ O
is -X- _ O
used -X- _ O
, -X- _ O
assuming -X- _ O
an -X- _ O
independent -X- _ O
posterior -X- _ O
is -X- _ O
not -X- _ O
appropriate -X- _ O
. -X- _ O
Hence -X- _ O
, -X- _ O
we -X- _ O
follow -X- _ O
the -X- _ O
tree -X- _ O
- -X- _ O
structured -X- _ O
prior -X- _ O
and -X- _ O
also -X- _ O
construct -X- _ O
a -X- _ O
tree -X- _ O
- -X- _ O
structured -X- _ O
posterior -X- _ O

q -X- _ O
T -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
= -X- _ O
i∈V -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
j -X- _ O
) -X- _ O
, -X- _ O

where -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
is -X- _ O
the -X- _ O
same -X- _ O
as -X- _ O
that -X- _ O
in -X- _ O
( -X- _ O
8 -X- _ O
) -X- _ O
; -X- _ O
and -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
is -X- _ O
also -X- _ O
defined -X- _ O
to -X- _ O
be -X- _ O
Gaussian -X- _ O
, -X- _ O
with -X- _ O
its -X- _ O
mean -X- _ O
defined -X- _ O
as -X- _ O
[ -X- _ O
µ -X- _ O
i -X- _ O
; -X- _ O
µ -X- _ O
j -X- _ O
] -X- _ O
and -X- _ O
covariance -X- _ O
matrix -X- _ O
defined -X- _ O
as -X- _ O

diag -X- _ O
( -X- _ O
σ -X- _ O
2 -X- _ O
i -X- _ O
) -X- _ O
diag -X- _ O
( -X- _ O
γ -X- _ O
ij -X- _ O
σ -X- _ O
i -X- _ O
σ -X- _ O
j -X- _ O
) -X- _ O
diag -X- _ O
( -X- _ O
γ -X- _ O
ij -X- _ O
σ -X- _ O
i -X- _ O
σ -X- _ O
j -X- _ O
) -X- _ O
diag -X- _ O
( -X- _ O
σ -X- _ O
2 -X- _ O
j -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
13 -X- _ O
) -X- _ O

in -X- _ O
which -X- _ O
γ -X- _ O
ij -X- _ O
∈ -X- _ O
R -X- _ O
d -X- _ O
controls -X- _ O
the -X- _ O
correlation -X- _ B-MetricName
strength -X- _ O
between -X- _ O
z -X- _ O
i -X- _ O
and -X- _ O
z -X- _ O
j -X- _ O
, -X- _ O
whose -X- _ O
elements -X- _ O
are -X- _ O
restricted -X- _ O
in -X- _ O
( -X- _ O
−1 -X- _ O
, -X- _ O
1 -X- _ O
) -X- _ O
and -X- _ O
denotes -X- _ O
the -X- _ O
Hadamard -X- _ O
product -X- _ O
. -X- _ O
By -X- _ O
taking -X- _ O
the -X- _ O
correlated -X- _ O
posterior -X- _ O
q -X- _ O
T -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
into -X- _ O
the -X- _ O
ELBO -X- _ B-MetricName
, -X- _ O
we -X- _ O
obtain -X- _ O

L -X- _ O
T -X- _ O
= -X- _ O
i∈V -X- _ O
E -X- _ O
q -X- _ O
φ -X- _ O
[ -X- _ O
log -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
|z -X- _ O
i -X- _ O
) -X- _ O
] -X- _ O
−KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
) -X- _ O
− -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
) -X- _ O
−KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
) -X- _ O
−KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
) -X- _ O
, -X- _ O

where -X- _ O
we -X- _ O
briefly -X- _ O
denote -X- _ O
the -X- _ O
variational -X- _ O
distribution -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
as -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
. -X- _ O
Since -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
, -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
, -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
and -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
are -X- _ O
all -X- _ O
Gaussian -X- _ O
distributions -X- _ O
, -X- _ O
the -X- _ O
KL -X- _ B-MetricName
- -X- _ I-MetricName
divergence -X- _ I-MetricName
terms -X- _ O
above -X- _ O
can -X- _ O
be -X- _ O
derived -X- _ O
in -X- _ O
closed -X- _ O
- -X- _ O
form -X- _ O
. -X- _ O
Moreover -X- _ O
, -X- _ O
it -X- _ O
can -X- _ O
be -X- _ O
seen -X- _ O
that -X- _ O
L -X- _ O
T -X- _ O
involves -X- _ O
only -X- _ O
single -X- _ O
or -X- _ O
pairwise -X- _ O
variables -X- _ O
, -X- _ O
thus -X- _ O
optimizing -X- _ O
it -X- _ O
is -X- _ O
as -X- _ O
efficient -X- _ O
as -X- _ O
the -X- _ O
models -X- _ O
without -X- _ O
considering -X- _ O
document -X- _ O
correlation -X- _ O
. -X- _ O
With -X- _ O
the -X- _ O
trained -X- _ O
model -X- _ O
, -X- _ O
hash -X- _ O
codes -X- _ O
can -X- _ O
be -X- _ O
obtained -X- _ O
by -X- _ O
binarizing -X- _ O
the -X- _ O
posterior -X- _ O
mean -X- _ O
µ -X- _ O
i -X- _ O
with -X- _ O
a -X- _ O
threshold -X- _ O
, -X- _ O
as -X- _ O
done -X- _ O
in -X- _ O
( -X- _ O
Chaidaroon -X- _ O
and -X- _ O
Fang -X- _ O
, -X- _ O
2017 -X- _ O
) -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
if -X- _ O
without -X- _ O
any -X- _ O
constraint -X- _ O
, -X- _ O
the -X- _ O
range -X- _ O
of -X- _ O
mean -X- _ O
lies -X- _ O
in -X- _ O
( -X- _ O
−∞ -X- _ O
, -X- _ O
+ -X- _ O
∞ -X- _ O
) -X- _ O
. -X- _ O
Thus -X- _ O
, -X- _ O
if -X- _ O
we -X- _ O
binarize -X- _ O
it -X- _ O
directly -X- _ O
, -X- _ O
lots -X- _ O
of -X- _ O
information -X- _ O
in -X- _ O
the -X- _ O
original -X- _ O
representations -X- _ O
will -X- _ O
be -X- _ O
lost -X- _ O
. -X- _ O
To -X- _ O
alleviate -X- _ O
this -X- _ O
problem -X- _ O
, -X- _ O
in -X- _ O
our -X- _ O
implementation -X- _ O
, -X- _ O
we -X- _ O
parameterize -X- _ O
the -X- _ O
posterior -X- _ O
mean -X- _ O
µ -X- _ O
i -X- _ O
by -X- _ O
a -X- _ O
function -X- _ O
of -X- _ O
the -X- _ O
form -X- _ O
µ -X- _ O
i -X- _ O
= -X- _ O
sigmoid -X- _ O
( -X- _ O
nn -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
/ -X- _ O
τ -X- _ O
) -X- _ O
, -X- _ O
where -X- _ O
the -X- _ O
outermost -X- _ O
sigmoid -X- _ O
function -X- _ O
forces -X- _ O
the -X- _ O
mean -X- _ O
to -X- _ O
look -X- _ O
like -X- _ O
binary -X- _ O
value -X- _ O
and -X- _ O
thus -X- _ O
can -X- _ O
effectively -X- _ O
reduce -X- _ O
the -X- _ O
quantization -X- _ O
loss -X- _ O
, -X- _ O
with -X- _ O
nn -X- _ O
( -X- _ O
• -X- _ O
) -X- _ O
denoting -X- _ O
a -X- _ O
neural -X- _ O
network -X- _ O
function -X- _ O
and -X- _ O
τ -X- _ O
controlling -X- _ O
the -X- _ O
slope -X- _ O
of -X- _ O
the -X- _ O
sigmoid -X- _ O
function -X- _ O
. -X- _ O

Extending -X- _ O
to -X- _ O
Multiple -X- _ O
Spanning -X- _ O
Trees -X- _ O

Obviously -X- _ O
, -X- _ O
approximating -X- _ O
the -X- _ O
graph -X- _ O
with -X- _ O
a -X- _ O
spanning -X- _ O
tree -X- _ O
may -X- _ O
lose -X- _ O
too -X- _ O
much -X- _ O
information -X- _ O
. -X- _ O
To -X- _ O
alleviate -X- _ O
this -X- _ O
issue -X- _ O
, -X- _ O
we -X- _ O
propose -X- _ O
to -X- _ O
capture -X- _ O
the -X- _ O
similarity -X- _ O
information -X- _ O
by -X- _ O
a -X- _ O
mixture -X- _ O
of -X- _ O
multiple -X- _ O
distributions -X- _ O
, -X- _ O
with -X- _ O
each -X- _ O
built -X- _ O
on -X- _ O
a -X- _ O
spanning -X- _ O
tree -X- _ O
. -X- _ O
Specifically -X- _ O
, -X- _ O
we -X- _ O
first -X- _ O
construct -X- _ O
a -X- _ O
set -X- _ O
of -X- _ O
M -X- _ O
spanning -X- _ O
trees -X- _ O

T -X- _ O
G -X- _ O
= -X- _ O
{ -X- _ O
T -X- _ O
1 -X- _ O
, -X- _ O
T -X- _ O
2 -X- _ O
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
T -X- _ O
M -X- _ O
} -X- _ O
from -X- _ O
the -X- _ O
original -X- _ O
graph -X- _ O
G -X- _ O
. -X- _ O

Based -X- _ O
on -X- _ O
the -X- _ O
set -X- _ O
of -X- _ O
spanning -X- _ O
trees -X- _ O
, -X- _ O
a -X- _ O
mixturedistribution -X- _ O
prior -X- _ O
and -X- _ O
posterior -X- _ O
can -X- _ O
be -X- _ O
constructed -X- _ O
as -X- _ O

p -X- _ O
MT -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
= -X- _ O
1 -X- _ O
M -X- _ O
T -X- _ O
∈T -X- _ O
G -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
14 -X- _ O
) -X- _ O

q -X- _ O
MT -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
= -X- _ O
1 -X- _ O
M -X- _ O
T -X- _ O
∈T -X- _ O
G -X- _ O
q -X- _ O
T -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
, -X- _ O
( -X- _ O
15 -X- _ O
) -X- _ O

where -X- _ O
p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
and -X- _ O
q -X- _ O
T -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
are -X- _ O
the -X- _ O
prior -X- _ O
and -X- _ O
posterior -X- _ O
defined -X- _ O
on -X- _ O
the -X- _ O
tree -X- _ O
T -X- _ O
, -X- _ O
as -X- _ O
done -X- _ O
in -X- _ O
( -X- _ O
11 -X- _ O
) -X- _ O
and -X- _ O
( -X- _ O
13 -X- _ O
) -X- _ O
. -X- _ O
By -X- _ O
taking -X- _ O
the -X- _ O
mixture -X- _ O
distributions -X- _ O
above -X- _ O
into -X- _ O
the -X- _ O
ELBO -X- _ B-MetricName
of -X- _ O
L -X- _ O
to -X- _ O
replace -X- _ O
the -X- _ O
prior -X- _ O
and -X- _ O
posterior -X- _ O
, -X- _ O
we -X- _ O
can -X- _ O
obtain -X- _ O
a -X- _ O
new -X- _ O
ELBO -X- _ B-MetricName
, -X- _ O
denoted -X- _ O
as -X- _ O
L -X- _ O
MT -X- _ O
. -X- _ O
Obviously -X- _ O
, -X- _ O
it -X- _ O
is -X- _ O
impossible -X- _ O
to -X- _ O
obtain -X- _ O
a -X- _ O
closed -X- _ O
- -X- _ O
form -X- _ O
expression -X- _ O
for -X- _ O
the -X- _ O
bound -X- _ O
L -X- _ O
MT -X- _ O
. -X- _ O
But -X- _ O
as -X- _ O
proved -X- _ O
in -X- _ O
( -X- _ O
Tang -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2019 -X- _ O
) -X- _ O
, -X- _ O
by -X- _ O
using -X- _ O
the -X- _ O
log -X- _ O
- -X- _ O
sum -X- _ O
inequality -X- _ O
, -X- _ O
L -X- _ O
MT -X- _ O
can -X- _ O
be -X- _ O
further -X- _ O
lower -X- _ O
bounded -X- _ O
by -X- _ O

L -X- _ O
MT -X- _ O
= -X- _ O
1 -X- _ O
M -X- _ O
T -X- _ O
∈T -X- _ O
G -X- _ O
L -X- _ O
T -X- _ O
. -X- _ O
( -X- _ O
16 -X- _ O
) -X- _ O

Given -X- _ O
the -X- _ O
expression -X- _ O
of -X- _ O
L -X- _ O
T -X- _ O
, -X- _ O
the -X- _ O
lower -X- _ O
bound -X- _ O
of -X- _ O
L -X- _ O
MT -X- _ O
can -X- _ O
also -X- _ O
be -X- _ O
expressed -X- _ O
in -X- _ O
closed -X- _ O
- -X- _ O
form -X- _ O
and -X- _ O
optimized -X- _ O
efficiently -X- _ O
. -X- _ O
For -X- _ O
detailed -X- _ O
derivations -X- _ O
and -X- _ O
concrete -X- _ O
expressions -X- _ O
, -X- _ O
please -X- _ O
refer -X- _ O
to -X- _ O
the -X- _ O
Supplementary -X- _ O
. -X- _ O

Details -X- _ O
of -X- _ O
Modeling -X- _ O

The -X- _ O
parameters -X- _ O
µ -X- _ O
i -X- _ O
, -X- _ O
µ -X- _ O
j -X- _ O
, -X- _ O
σ -X- _ O
i -X- _ O
, -X- _ O
σ -X- _ O
j -X- _ O
and -X- _ O
γ -X- _ O
ij -X- _ O
in -X- _ O
the -X- _ O
approximate -X- _ O
posterior -X- _ O
distribution -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
of -X- _ O
( -X- _ O
8 -X- _ O
) -X- _ O
and -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
of -X- _ O
( -X- _ O
13 -X- _ O
) -X- _ O
are -X- _ O
all -X- _ O
defined -X- _ O
as -X- _ O
the -X- _ O
outputs -X- _ O
of -X- _ O
neural -X- _ O
networks -X- _ O
, -X- _ O
with -X- _ O
the -X- _ O
parameters -X- _ O
denoted -X- _ O
as -X- _ O
φ -X- _ O
. -X- _ O
Specifically -X- _ O
, -X- _ O
the -X- _ O
entire -X- _ O
model -X- _ O
is -X- _ O
mainly -X- _ O
composed -X- _ O
of -X- _ O
three -X- _ O
components -X- _ O
: -X- _ O

i -X- _ O
) -X- _ O
The -X- _ O
variational -X- _ O
encoder -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
, -X- _ O
which -X- _ O
takes -X- _ O
single -X- _ O
document -X- _ O
as -X- _ O
input -X- _ O
, -X- _ O
and -X- _ O
outputs -X- _ O
the -X- _ O
mean -X- _ O
and -X- _ O
variance -X- _ O
of -X- _ O
Gaussian -X- _ O
distribution -X- _ O
, -X- _ O
i.e. -X- _ O
, -X- _ O
[ -X- _ O
µ -X- _ O
i -X- _ O
; -X- _ O

σ -X- _ O
2 -X- _ O
i -X- _ O
] -X- _ O
= -X- _ O
f -X- _ O
φ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
; -X- _ O

ii -X- _ O
) -X- _ O
The -X- _ O
correlated -X- _ O
encoder -X- _ O
, -X- _ O
which -X- _ O
takes -X- _ O
pairwise -X- _ O
documents -X- _ O
as -X- _ O
input -X- _ O
, -X- _ O
and -X- _ O
outputs -X- _ O
the -X- _ O
correlation -X- _ B-MetricName
coefficient -X- _ O
, -X- _ O
i.e. -X- _ O
, -X- _ O
γ -X- _ O
ij -X- _ O
= -X- _ O
f -X- _ O
φ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
. -X- _ O

Note -X- _ O
that -X- _ O
the -X- _ O
correlation -X- _ B-MetricName
encoder -X- _ O
is -X- _ O
required -X- _ O
to -X- _ O
be -X- _ O
order -X- _ O
- -X- _ O
irrelevant -X- _ O
, -X- _ O
that -X- _ O
is -X- _ O
, -X- _ O
f -X- _ O
φ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
= -X- _ O
f -X- _ O
φ -X- _ O
( -X- _ O
x -X- _ O
j -X- _ O
, -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
, -X- _ O
which -X- _ O
is -X- _ O
achieved -X- _ O
in -X- _ O
this -X- _ O
paper -X- _ O
as -X- _ O

f -X- _ O
φ -X- _ O
= -X- _ O
1 -X- _ O
2 -X- _ O
f -X- _ O
φ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
+ -X- _ O
f -X- _ O
φ -X- _ O
( -X- _ O
x -X- _ O
j -X- _ O
, -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
; -X- _ O

iii -X- _ O
) -X- _ O
The -X- _ O
generative -X- _ O
decoder -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
|z -X- _ O
i -X- _ O
) -X- _ O
, -X- _ O
which -X- _ O
takes -X- _ O
the -X- _ O
latent -X- _ O
variable -X- _ O
z -X- _ O
i -X- _ O
as -X- _ O
input -X- _ O
and -X- _ O
output -X- _ O
the -X- _ O
document -X- _ O
x -X- _ O
i -X- _ O
. -X- _ O
The -X- _ O
decoder -X- _ O
is -X- _ O
modeled -X- _ O
by -X- _ O
a -X- _ O
neural -X- _ O
network -X- _ O
parameterized -X- _ O
by -X- _ O
θ -X- _ O
. -X- _ O

The -X- _ O
model -X- _ O
is -X- _ O
trained -X- _ O
by -X- _ O
optimizing -X- _ O
the -X- _ O
lower -X- _ O
bound -X- _ O
L -X- _ O
MT -X- _ O
w.r.t -X- _ O
. -X- _ O
φ -X- _ O
and -X- _ O
θ -X- _ O
. -X- _ O
After -X- _ O
training -X- _ O
, -X- _ O
hash -X- _ O
codes -X- _ O
are -X- _ O
obtained -X- _ O
by -X- _ O
passing -X- _ O
the -X- _ O
documents -X- _ O
through -X- _ O
the -X- _ O
variational -X- _ O
encoder -X- _ O
and -X- _ O
binarizing -X- _ O
the -X- _ O
outputs -X- _ O
on -X- _ O
every -X- _ O
dimension -X- _ O
by -X- _ O
a -X- _ O
the -X- _ O
threshold -X- _ O
value -X- _ O
, -X- _ O
which -X- _ O
is -X- _ O
simply -X- _ O
set -X- _ O
as -X- _ O
0.5 -X- _ O
in -X- _ O
our -X- _ O
experiments -X- _ O
. -X- _ O

To -X- _ O
intuitively -X- _ O
understand -X- _ O
the -X- _ O
insight -X- _ O
behind -X- _ O
our -X- _ O
model -X- _ O
, -X- _ O
an -X- _ O
illustration -X- _ O
is -X- _ O
shown -X- _ O
in -X- _ O
Figure -X- _ O
1 -X- _ O
. -X- _ O
We -X- _ O
see -X- _ O
that -X- _ O
if -X- _ O
the -X- _ O
two -X- _ O
documents -X- _ O
are -X- _ O
neighbors -X- _ O
and -X- _ O
semantically -X- _ O
similar -X- _ O
, -X- _ O
the -X- _ O
representations -X- _ O
will -X- _ O
be -X- _ O
strongly -X- _ O
correlated -X- _ O
to -X- _ O
each -X- _ O
other -X- _ O
. -X- _ O
But -X- _ O
if -X- _ O
they -X- _ O
are -X- _ O
not -X- _ O
semantically -X- _ O
similar -X- _ O
neighbors -X- _ O
, -X- _ O
the -X- _ O
representations -X- _ O
become -X- _ O
less -X- _ O
correlated -X- _ O
. -X- _ O
If -X- _ O
they -X- _ O
are -X- _ O
neither -X- _ O
neighbors -X- _ O
nor -X- _ O
semantically -X- _ O
similar -X- _ O
, -X- _ O
the -X- _ O
representations -X- _ O
become -X- _ O
not -X- _ O
correlated -X- _ O
at -X- _ O
all -X- _ O
. -X- _ O
Since -X- _ O
our -X- _ O
model -X- _ O
can -X- _ O
simultaneously -X- _ O
preserve -X- _ O
semantics -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
, -X- _ O
we -X- _ O
name -X- _ O
it -X- _ O
as -X- _ O
Semantics -X- _ B-MethodName
- -X- _ I-MethodName
Neighborhood -X- _ I-MethodName
Unified -X- _ I-MethodName
Hahing -X- _ I-MethodName
( -X- _ O
SNUH -X- _ B-MethodName
) -X- _ O
. -X- _ O

Related -X- _ O
Work -X- _ O

Deep -X- _ O
generative -X- _ O
models -X- _ O
( -X- _ O
Rezende -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2014 -X- _ O
) -X- _ O
have -X- _ O
attracted -X- _ O
a -X- _ O
lot -X- _ O
of -X- _ O
attention -X- _ O
in -X- _ O
semanticsbased -X- _ O
hashing -X- _ O
, -X- _ O
due -X- _ O
to -X- _ O
their -X- _ O
successes -X- _ O
in -X- _ O
unsupervised -X- _ O
representation -X- _ O
learning -X- _ O
. -X- _ O
VDSH -X- _ B-MethodName
( -X- _ O
Chaidaroon -X- _ O
and -X- _ O
Fang -X- _ O
, -X- _ O
2017 -X- _ O
) -X- _ O
first -X- _ O
employed -X- _ O
variational -X- _ O
autoencoder -X- _ O
( -X- _ O
VAE -X- _ O
) -X- _ O
( -X- _ O
Kingma -X- _ O
and -X- _ O
Welling -X- _ O
, -X- _ O
2013 -X- _ O
) -X- _ O
to -X- _ O
learn -X- _ O
continuous -X- _ O
representations -X- _ O
of -X- _ O
documents -X- _ O
and -X- _ O
then -X- _ O
casts -X- _ O
them -X- _ O
into -X- _ O
binary -X- _ O
codes -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
for -X- _ O
the -X- _ O
sake -X- _ O
of -X- _ O
information -X- _ O
leaky -X- _ O
problem -X- _ O
during -X- _ O
binarization -X- _ O
step -X- _ O
, -X- _ O
such -X- _ O
a -X- _ O
two -X- _ O
- -X- _ O
stage -X- _ O
strategy -X- _ O
is -X- _ O
prone -X- _ O
to -X- _ O
result -X- _ O
in -X- _ O
local -X- _ O
optima -X- _ O
and -X- _ O
undermine -X- _ O
the -X- _ O
performance -X- _ O
. -X- _ O
NASH -X- _ B-MethodName
( -X- _ O
Shen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2018 -X- _ O
) -X- _ O
tackled -X- _ O
this -X- _ O
issue -X- _ O
by -X- _ O
replacing -X- _ O
the -X- _ O
Gaussian -X- _ O
prior -X- _ O
with -X- _ O
Bernoulli -X- _ O
and -X- _ O
adopted -X- _ O
the -X- _ O
straight -X- _ O
- -X- _ O
through -X- _ O
technique -X- _ O
( -X- _ O
Bengio -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2013 -X- _ O
) -X- _ O
to -X- _ O
achieve -X- _ O
end -X- _ O
- -X- _ O
to -X- _ O
- -X- _ O
end -X- _ O
training -X- _ O
. -X- _ O
To -X- _ O
further -X- _ O
improve -X- _ O
the -X- _ O
model -X- _ O
's -X- _ O
capability -X- _ O
, -X- _ O
Dong -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
( -X- _ O
2019 -X- _ O
) -X- _ O
proposed -X- _ O
to -X- _ O
employ -X- _ O
mixture -X- _ O
distribution -X- _ O
as -X- _ O
a -X- _ O
priori -X- _ O
knowledge -X- _ O
and -X- _ O
Zheng -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
( -X- _ O
2020 -X- _ O
) -X- _ O
exploited -X- _ O
Boltzmann -X- _ O
posterior -X- _ O
to -X- _ O
introduce -X- _ O
correlation -X- _ B-MetricName
among -X- _ O
bits -X- _ O
. -X- _ O
Beyond -X- _ O
generative -X- _ O
frameworks -X- _ O
, -X- _ O
AMMI -X- _ B-MethodName
( -X- _ O
Stratos -X- _ O
and -X- _ O
Wiseman -X- _ O
, -X- _ O
2020 -X- _ O
) -X- _ O
achieved -X- _ O
superior -X- _ O
performance -X- _ O
by -X- _ O
maximizing -X- _ O
the -X- _ O
mutual -X- _ O
information -X- _ O
between -X- _ O
codes -X- _ O
and -X- _ O
documents -X- _ O
. -X- _ O
Nevertheless -X- _ O
, -X- _ O
the -X- _ O
aforementioned -X- _ O
semantic -X- _ O
hashing -X- _ O
methods -X- _ O
are -X- _ O
consistently -X- _ O
under -X- _ O
the -X- _ O
i.i.d -X- _ O
. -X- _ O
assumption -X- _ O
, -X- _ O
which -X- _ O
means -X- _ O
they -X- _ O
ignore -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
. -X- _ O

Spectral -X- _ O
hashing -X- _ O
( -X- _ O
Weiss -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2009 -X- _ O
) -X- _ O
and -X- _ O
selftaught -X- _ O
hashing -X- _ O
( -X- _ O
Zhang -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2010 -X- _ O
) -X- _ O
are -X- _ O
two -X- _ O
typical -X- _ O
methods -X- _ O
of -X- _ O
neighbor -X- _ O
- -X- _ O
based -X- _ O
hashing -X- _ O
models -X- _ O
. -X- _ O
But -X- _ O
these -X- _ O
algorithms -X- _ O
generally -X- _ O
ignore -X- _ O
the -X- _ O
rich -X- _ O
semantic -X- _ O
information -X- _ O
associated -X- _ O
with -X- _ O
documents -X- _ O
. -X- _ O
Recently -X- _ O
, -X- _ O
some -X- _ O
VAE -X- _ O
- -X- _ O
based -X- _ O
models -X- _ O
tried -X- _ O
to -X- _ O
concurrently -X- _ O
take -X- _ O
account -X- _ O
of -X- _ O
semantic -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
, -X- _ O
such -X- _ O
as -X- _ O
NbrReg -X- _ B-MethodName
( -X- _ O
Chaidaroon -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2018 -X- _ O
) -X- _ O
, -X- _ O
RBSH -X- _ B-MethodName
( -X- _ O
Hansen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2019 -X- _ O
) -X- _ O
and -X- _ O
PairRec -X- _ B-MethodName
( -X- _ O
Hansen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2020 -X- _ O
) -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
as -X- _ O
mentioned -X- _ O
before -X- _ O
, -X- _ O
all -X- _ O
of -X- _ O
them -X- _ O
simply -X- _ O
regarded -X- _ O
the -X- _ O
proximity -X- _ O
as -X- _ O
regularization -X- _ O
, -X- _ O
lacking -X- _ O
theoretical -X- _ O
principles -X- _ O
to -X- _ O
guide -X- _ O
the -X- _ O
incorporation -X- _ O
process -X- _ O
. -X- _ O
Thanks -X- _ O
to -X- _ O
the -X- _ O
virtue -X- _ O
of -X- _ O
graph -X- _ O
- -X- _ O
induced -X- _ O
distribution -X- _ O
, -X- _ O
we -X- _ O
effectively -X- _ O
preserve -X- _ O
the -X- _ O
two -X- _ O
types -X- _ O
of -X- _ O
information -X- _ O
in -X- _ O
a -X- _ O
theoretical -X- _ O
framework -X- _ O
. -X- _ O

Experiments -X- _ O

Experiment -X- _ O
Setup -X- _ O

Datasets -X- _ O
We -X- _ O
verify -X- _ O
the -X- _ O
proposed -X- _ O
methods -X- _ O
on -X- _ O
three -X- _ O
public -X- _ O
datasets -X- _ O
which -X- _ O
published -X- _ O
by -X- _ O
VDSH -X- _ B-MethodName
3 -X- _ O
: -X- _ O
i -X- _ O
) -X- _ O
Reuters25178 -X- _ B-DatasetName
, -X- _ O
which -X- _ O
contains -X- _ O
10,788 -X- _ O
news -X- _ O
documents -X- _ O
with -X- _ O
90 -X- _ O
different -X- _ O
categories -X- _ O
; -X- _ O
ii -X- _ O
) -X- _ O
TMC -X- _ B-DatasetName
, -X- _ O
which -X- _ O
is -X- _ O
a -X- _ O
collection -X- _ O
of -X- _ O
21,519 -X- _ O
air -X- _ O
traffic -X- _ O
reports -X- _ O
with -X- _ O
22 -X- _ O
different -X- _ O
categories -X- _ O
; -X- _ O
iii -X- _ O
) -X- _ O
20Newsgroups -X- _ B-DatasetName
( -X- _ O
NG20 -X- _ B-DatasetName
) -X- _ O
, -X- _ O
which -X- _ O
consists -X- _ O
of -X- _ O
18,828 -X- _ O
news -X- _ O
posts -X- _ O
from -X- _ O
20 -X- _ O
different -X- _ O
topics -X- _ O
. -X- _ O
Note -X- _ O
that -X- _ O
the -X- _ O
category -X- _ O
labels -X- _ O
of -X- _ O
each -X- _ O
dataset -X- _ O
are -X- _ O
only -X- _ O
used -X- _ O
to -X- _ O
compute -X- _ O
the -X- _ O
evaluation -X- _ O
metrics -X- _ O
, -X- _ O
as -X- _ O
we -X- _ O
focus -X- _ O
on -X- _ O
unsupervised -X- _ O
scenarios -X- _ O
. -X- _ O

Baselines -X- _ O
We -X- _ O
compare -X- _ O
our -X- _ O
method -X- _ O
with -X- _ O
the -X- _ O
following -X- _ O
models -X- _ O
: -X- _ O
SpH -X- _ B-MethodName
( -X- _ O
Weiss -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2009 -X- _ O
) -X- _ O
, -X- _ O
STH -X- _ B-MethodName
( -X- _ O
Zhang -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2010 -X- _ O
) -X- _ O
, -X- _ O
VDSH -X- _ B-MethodName
( -X- _ O
Chaidaroon -X- _ O
and -X- _ O
Fang -X- _ O
, -X- _ O
2017 -X- _ O
) -X- _ O
, -X- _ O
NASH -X- _ B-MethodName
( -X- _ O
Shen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2018 -X- _ O
) -X- _ O
, -X- _ O
GMSH -X- _ B-MethodName
( -X- _ O
Dong -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2019 -X- _ O
) -X- _ O
, -X- _ O
NbrReg -X- _ B-MethodName
( -X- _ O
Chaidaroon -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2018 -X- _ O
) -X- _ O
, -X- _ O
CorrSH -X- _ B-MethodName
( -X- _ O
Zheng -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2020 -X- _ O
) -X- _ O
and -X- _ O
AMMI -X- _ B-MethodName
( -X- _ O
Stratos -X- _ O
and -X- _ O
Wiseman -X- _ O
, -X- _ O
2020 -X- _ O
) -X- _ O
. -X- _ O
For -X- _ O
all -X- _ O
baselines -X- _ O
, -X- _ O
we -X- _ O
take -X- _ O
the -X- _ O
reported -X- _ O
performance -X- _ O
from -X- _ O
their -X- _ O
original -X- _ O
papers -X- _ O
. -X- _ O

Training -X- _ O
Details -X- _ O
For -X- _ O
fair -X- _ O
comparisons -X- _ O
, -X- _ O
we -X- _ O
follow -X- _ O
the -X- _ O
same -X- _ O
network -X- _ O
architecture -X- _ O
used -X- _ O
in -X- _ O
VDSH -X- _ B-MethodName
, -X- _ O
GMSH -X- _ B-MethodName
and -X- _ O
CorrSH -X- _ B-MethodName
, -X- _ O
using -X- _ O
a -X- _ O
one -X- _ O
- -X- _ O
layer -X- _ O
feedforward -X- _ O
neural -X- _ O
network -X- _ O
as -X- _ O
the -X- _ O
variational -X- _ O
and -X- _ O
the -X- _ O
correlated -X- _ O
encoder -X- _ O
. -X- _ O
The -X- _ O
graph -X- _ O
G -X- _ O
is -X- _ O
constructed -X- _ O
with -X- _ O
the -X- _ O
K -X- _ B-HyperparameterName
- -X- _ O
nearest -X- _ O
neighbors -X- _ O
( -X- _ O
KNN -X- _ O
) -X- _ O
algorithm -X- _ O
based -X- _ O
on -X- _ O
cosine -X- _ B-MetricName
similarity -X- _ I-MetricName
on -X- _ O
the -X- _ O
TFIDF -X- _ O
features -X- _ O
of -X- _ O
documents -X- _ O
. -X- _ O
In -X- _ O
our -X- _ O
experiments -X- _ O
, -X- _ O
the -X- _ O
correlation -X- _ B-HyperparameterName
strength -X- _ I-HyperparameterName
coefficient -X- _ I-HyperparameterName
λ -X- _ B-HyperparameterName
in -X- _ O
( -X- _ O
12 -X- _ O
) -X- _ O
is -X- _ O
fixed -X- _ O
to -X- _ O
0.99 -X- _ B-HyperparameterValue
. -X- _ O
According -X- _ O
to -X- _ O
the -X- _ O
performance -X- _ O
observed -X- _ O
on -X- _ O
the -X- _ O
validation -X- _ O
set -X- _ O
, -X- _ O
we -X- _ O
choose -X- _ O
the -X- _ O
learning -X- _ B-HyperparameterName
rate -X- _ I-HyperparameterName
from -X- _ O
{ -X- _ O
0.0005 -X- _ B-HyperparameterValue
, -X- _ O
0.001 -X- _ B-HyperparameterValue
, -X- _ O
0.003 -X- _ B-HyperparameterValue
} -X- _ O
, -X- _ O
batch -X- _ B-HyperparameterName
size -X- _ I-HyperparameterName
from -X- _ O
{ -X- _ O
32 -X- _ B-HyperparameterValue
, -X- _ O
64 -X- _ B-HyperparameterValue
, -X- _ O
128 -X- _ B-HyperparameterValue
} -X- _ O
, -X- _ O
the -X- _ O
temperature -X- _ B-HyperparameterName
τ -X- _ B-HyperparameterName
in -X- _ O
sigmoid -X- _ O
function -X- _ O
from -X- _ O
{ -X- _ O
0.1 -X- _ B-HyperparameterValue
, -X- _ O
0.2 -X- _ B-HyperparameterValue
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
1 -X- _ B-HyperparameterValue
} -X- _ O
, -X- _ O
the -X- _ O
number -X- _ B-HyperparameterName
of -X- _ I-HyperparameterName
trees -X- _ I-HyperparameterName
M -X- _ B-HyperparameterName
and -X- _ O
neighbors -X- _ B-HyperparameterName
K -X- _ B-HyperparameterName
both -X- _ O
form -X- _ O
{ -X- _ O
1,2 -X- _ B-HyperparameterValue
, -X- _ O
. -X- _ O
. -X- _ O
. -X- _ O
, -X- _ O
20 -X- _ B-HyperparameterValue
} -X- _ O
, -X- _ O
with -X- _ O
the -X- _ O
best -X- _ O
used -X- _ O
for -X- _ O
evaluation -X- _ O
on -X- _ O
the -X- _ O
test -X- _ O
set -X- _ O
. -X- _ O
The -X- _ O
model -X- _ O
is -X- _ O
trained -X- _ O
using -X- _ O
the -X- _ O
Adam -X- _ O
optimizer -X- _ O
( -X- _ O
Kingma -X- _ O
and -X- _ O
Ba -X- _ O
, -X- _ O
2014 -X- _ O
) -X- _ O
. -X- _ O
More -X- _ O
detailed -X- _ O
experimental -X- _ O
settings -X- _ O
, -X- _ O
along -X- _ O
with -X- _ O
the -X- _ O
generating -X- _ O
method -X- _ O
of -X- _ O
spanning -X- _ O
trees -X- _ O
, -X- _ O
are -X- _ O
given -X- _ O
in -X- _ O
the -X- _ O
supplementary -X- _ O
materials -X- _ O
. -X- _ O

Evaluation -X- _ O
Metrics -X- _ O

The -X- _ O
retrieval -X- _ B-MetricName
precision -X- _ I-MetricName
is -X- _ O
used -X- _ O
as -X- _ O
our -X- _ O
evaluation -X- _ O
metric -X- _ O
. -X- _ O
For -X- _ O
each -X- _ O
query -X- _ O
document -X- _ O
, -X- _ O
we -X- _ O
retrieve -X- _ O
100 -X- _ O
documents -X- _ O
most -X- _ O
similar -X- _ O
to -X- _ O
it -X- _ O
based -X- _ O
on -X- _ O
the -X- _ O
Hamming -X- _ B-MetricName
distance -X- _ I-MetricName
of -X- _ O
hash -X- _ O
codes -X- _ O
. -X- _ O
Then -X- _ O
, -X- _ O
the -X- _ O
retrieval -X- _ B-MetricName
precision -X- _ I-MetricName
for -X- _ O
a -X- _ O
single -X- _ O
sample -X- _ O
is -X- _ O
measured -X- _ O
as -X- _ O
the -X- _ O
percentage -X- _ O
of -X- _ O
the -X- _ O
retrieved -X- _ O
documents -X- _ O
with -X- _ O
the -X- _ O
same -X- _ O
label -X- _ O
as -X- _ O
the -X- _ O
query -X- _ O
. -X- _ O
Finally -X- _ O
, -X- _ O
the -X- _ O
average -X- _ B-MetricName
precision -X- _ I-MetricName
over -X- _ O
the -X- _ O
whole -X- _ O
test -X- _ O
set -X- _ O
is -X- _ O
calculated -X- _ O
as -X- _ O
the -X- _ O
performance -X- _ O
of -X- _ O
the -X- _ O
evaluated -X- _ O
method -X- _ O
. -X- _ O

Performance -X- _ O
and -X- _ O
Analysis -X- _ O

Overall -X- _ O
Performance -X- _ O
The -X- _ O
performances -X- _ O
of -X- _ O
all -X- _ O
the -X- _ O
models -X- _ O
on -X- _ O
the -X- _ O
three -X- _ O
public -X- _ O
datasets -X- _ O
are -X- _ O
shown -X- _ O
in -X- _ O
Table -X- _ O
1 -X- _ O
. -X- _ O
We -X- _ O
see -X- _ O
that -X- _ O
our -X- _ O
model -X- _ O
performs -X- _ O
favorably -X- _ O

Method -X- _ O

Reuters -X- _ B-DatasetName
TMC -X- _ B-DatasetName
20Newsgroups -X- _ B-DatasetName
Avg -X- _ O
16bits -X- _ O
32bits -X- _ O
64bits -X- _ O
128bits -X- _ O
16bits -X- _ O
32bits -X- _ O
64bits -X- _ O
128bits -X- _ O
16bits -X- _ O
32bits -X- _ O
64bits -X- _ O
128bits -X- _ O
to -X- _ O
the -X- _ O
current -X- _ O
state -X- _ O
- -X- _ O
of -X- _ O
- -X- _ O
the -X- _ O
- -X- _ O
art -X- _ O
method -X- _ O
, -X- _ O
yielding -X- _ O
best -X- _ O
average -X- _ O
performance -X- _ O
across -X- _ O
different -X- _ O
datasets -X- _ O
and -X- _ O
settings -X- _ O
. -X- _ O
Compared -X- _ O
with -X- _ O
VDSH -X- _ B-MethodName
and -X- _ O
NASH -X- _ B-MethodName
, -X- _ O
which -X- _ O
simply -X- _ O
employ -X- _ O
isotropic -X- _ O
Gaussian -X- _ O
and -X- _ O
Bernoulli -X- _ O
prior -X- _ O
, -X- _ O
respectively -X- _ O
, -X- _ O
we -X- _ O
can -X- _ O
observe -X- _ O
that -X- _ O
our -X- _ O
model -X- _ O
, -X- _ O
which -X- _ O
leverages -X- _ O
correlated -X- _ O
prior -X- _ O
and -X- _ O
posterior -X- _ O
distributions -X- _ O
, -X- _ O
achieves -X- _ O
better -X- _ O
results -X- _ O
on -X- _ O
all -X- _ O
the -X- _ O
three -X- _ O
datasets -X- _ O
. -X- _ O
Although -X- _ O
GMSH -X- _ B-MethodName
improves -X- _ O
performance -X- _ O
by -X- _ O
exploiting -X- _ O
a -X- _ O
more -X- _ O
expressive -X- _ O
Gaussian -X- _ O
mixture -X- _ O
prior -X- _ O
, -X- _ O
our -X- _ O
model -X- _ O
still -X- _ O
outperforms -X- _ O
it -X- _ O
by -X- _ O
a -X- _ O
substantial -X- _ O
margin -X- _ O
, -X- _ O
indicating -X- _ O
the -X- _ O
superiority -X- _ O
of -X- _ O
incorporating -X- _ O
document -X- _ O
correlations -X- _ O
. -X- _ O
It -X- _ O
is -X- _ O
worth -X- _ O
noting -X- _ O
that -X- _ O
, -X- _ O
by -X- _ O
unifying -X- _ O
semantics -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
under -X- _ O
the -X- _ O
generative -X- _ O
models -X- _ O
, -X- _ O
the -X- _ O
two -X- _ O
types -X- _ O
of -X- _ O
information -X- _ O
can -X- _ O
be -X- _ O
preserved -X- _ O
more -X- _ O
effectively -X- _ O
. -X- _ O
This -X- _ O
can -X- _ O
be -X- _ O
validated -X- _ O
by -X- _ O
that -X- _ O
our -X- _ O
model -X- _ O
performs -X- _ O
significantly -X- _ O
better -X- _ O
than -X- _ O
NbrReg -X- _ B-MethodName
, -X- _ O
which -X- _ O
naively -X- _ O
incorporates -X- _ O
the -X- _ O
neighborhood -X- _ O
information -X- _ O
by -X- _ O
using -X- _ O
a -X- _ O
neighbor -X- _ O
- -X- _ O
reconstruction -X- _ O
regularizer -X- _ O
. -X- _ O
The -X- _ O
superiority -X- _ O
of -X- _ O
our -X- _ O
unified -X- _ O
method -X- _ O
can -X- _ O
be -X- _ O
further -X- _ O
corroborated -X- _ O
in -X- _ O
the -X- _ O
comparisons -X- _ O
with -X- _ O
RBSH -X- _ B-MethodName
and -X- _ O
PairRec -X- _ B-MethodName
, -X- _ O
which -X- _ O
are -X- _ O
given -X- _ O
in -X- _ O
the -X- _ O
Supplementary -X- _ O
since -X- _ O
they -X- _ O
employed -X- _ O
a -X- _ O
different -X- _ O
preprocessing -X- _ O
method -X- _ O
as -X- _ O
the -X- _ O
models -X- _ O
reported -X- _ O
here -X- _ O
. -X- _ O
Comparing -X- _ O
to -X- _ O
the -X- _ O
current -X- _ O
SOTA -X- _ O
methods -X- _ O
of -X- _ O
AMMI -X- _ B-MethodName
and -X- _ O
CorrSh -X- _ B-MethodName
, -X- _ O
our -X- _ O
method -X- _ O
is -X- _ O
still -X- _ O
able -X- _ O
to -X- _ O
achieve -X- _ O
better -X- _ O
results -X- _ O
by -X- _ O
exploiting -X- _ O
the -X- _ O
correlation -X- _ O
among -X- _ O
documents -X- _ O
. -X- _ O
Moreover -X- _ O
, -X- _ O
thanks -X- _ O
to -X- _ O
the -X- _ O
benefit -X- _ O
of -X- _ O
correlation -X- _ O
regularization -X- _ O
, -X- _ O
remarkable -X- _ O
gratuity -X- _ O
can -X- _ O
be -X- _ O
acquired -X- _ O
profitably -X- _ O
in -X- _ O
64 -X- _ O
and -X- _ O
128 -X- _ O
bits -X- _ O
. -X- _ O

Impact -X- _ O
of -X- _ O
Introducing -X- _ O
Correlations -X- _ B-MethodName
in -X- _ O
Prior -X- _ O
and -X- _ O
Posterior -X- _ O

To -X- _ O
understand -X- _ O
the -X- _ O
influences -X- _ O
of -X- _ O
the -X- _ O
proposed -X- _ O
document -X- _ O
- -X- _ O
correlated -X- _ O
prior -X- _ O
and -X- _ O
posterior -X- _ O
, -X- _ O
we -X- _ O
further -X- _ O
experiment -X- _ O
with -X- _ O
two -X- _ O
variants -X- _ O
of -X- _ O
our -X- _ O
model -X- _ O
: -X- _ O
i -X- _ O
) -X- _ O
SNUH -X- _ B-MethodName
ind -X- _ I-MethodName
: -X- _ O
which -X- _ O
does -X- _ O
not -X- _ O
consider -X- _ O
document -X- _ O
correlations -X- _ O
in -X- _ O
neither -X- _ O
the -X- _ O
prior -X- _ O
nor -X- _ O
the -X- _ O
posterior -X- _ O
distribution -X- _ O
; -X- _ O
ii -X- _ O
) -X- _ O
SNUH -X- _ B-MethodName
prior -X- _ I-MethodName
: -X- _ O
which -X- _ O
only -X- _ O
considers -X- _ O
the -X- _ O
correlations -X- _ O
in -X- _ O
the -X- _ O
prior -X- _ O
, -X- _ O
but -X- _ O
not -X- _ O
in -X- _ O
the -X- _ O
posterior -X- _ O
. -X- _ O
Obviously -X- _ O
, -X- _ O
the -X- _ O
proposed -X- _ O
SNUH -X- _ B-MethodName
represents -X- _ O
the -X- _ O
method -X- _ O
that -X- _ O
leverage -X- _ O
the -X- _ O
correlations -X- _ O
in -X- _ O
both -X- _ O
of -X- _ O
the -X- _ O
prior -X- _ O
and -X- _ O
posterior -X- _ O
. -X- _ O
As -X- _ O
seen -X- _ O
from -X- _ O
Table -X- _ O
2 -X- _ O
, -X- _ O
SNUH -X- _ B-MethodName
prior -X- _ I-MethodName
achieves -X- _ O
better -X- _ O
performance -X- _ O
than -X- _ O
SNUH -X- _ B-MethodName
ind -X- _ I-MethodName
, -X- _ O
demonstrating -X- _ O
the -X- _ O
benefit -X- _ O
of -X- _ O
considering -X- _ O
the -X- _ O
correlation -X- _ B-MetricName
information -X- _ O
of -X- _ O
documents -X- _ O
only -X- _ O
in -X- _ O
the -X- _ O
prior -X- _ O
. -X- _ O
By -X- _ O
further -X- _ O
taking -X- _ O
the -X- _ O
correlations -X- _ B-MetricName
into -X- _ O
account -X- _ O
in -X- _ O
the -X- _ O
posterior -X- _ O
, -X- _ O
improvements -X- _ O
of -X- _ O
SNUH -X- _ B-MethodName
can -X- _ O
be -X- _ O
further -X- _ O
observed -X- _ O
, -X- _ O
which -X- _ O
fully -X- _ O
corroborates -X- _ O
the -X- _ O
superiority -X- _ O
of -X- _ O
considering -X- _ O
document -X- _ O
correlations -X- _ B-MetricName
in -X- _ O
the -X- _ O
prior -X- _ O
and -X- _ O
posterior -X- _ O
. -X- _ O
Another -X- _ O
interesting -X- _ O
observation -X- _ O
is -X- _ O
that -X- _ O
the -X- _ O
performance -X- _ O
gap -X- _ O
be- -X- _ O
Table -X- _ O
3 -X- _ O
: -X- _ O
Qualitative -X- _ O
analysis -X- _ O
of -X- _ O
the -X- _ O
learned -X- _ O
128 -X- _ O
- -X- _ O
bit -X- _ O
hash -X- _ O
codes -X- _ O
on -X- _ O
the -X- _ O
20Newsgroups -X- _ B-DatasetName
dataset -X- _ O
. -X- _ O
We -X- _ O
present -X- _ O
the -X- _ O
documents -X- _ O
with -X- _ O
Hamming -X- _ B-MetricName
distance -X- _ I-MetricName
of -X- _ O
1 -X- _ B-MetricValue
, -X- _ O
10 -X- _ B-MetricValue
, -X- _ O
20 -X- _ B-MetricValue
, -X- _ O
50 -X- _ B-MetricValue
, -X- _ O
70 -X- _ B-MetricValue
and -X- _ O
90 -X- _ B-MetricValue
to -X- _ O
the -X- _ O
query -X- _ O
. -X- _ O

tween -X- _ O
SNUH -X- _ B-MethodName
ind -X- _ I-MethodName
and -X- _ O
SNUH -X- _ B-MethodName
prior -X- _ I-MethodName
becomes -X- _ O
small -X- _ O
as -X- _ O
the -X- _ O
length -X- _ O
of -X- _ O
bits -X- _ O
increases -X- _ O
. -X- _ O
This -X- _ O
may -X- _ O
be -X- _ O
attributed -X- _ O
to -X- _ O
the -X- _ O
fact -X- _ O
that -X- _ O
the -X- _ O
increased -X- _ O
generalization -X- _ O
ability -X- _ O
of -X- _ O
models -X- _ O
brought -X- _ O
by -X- _ O
large -X- _ O
bits -X- _ O
is -X- _ O
inclined -X- _ O
to -X- _ O
alleviate -X- _ O
the -X- _ O
impact -X- _ O
of -X- _ O
priori -X- _ O
knowledge -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
by -X- _ O
additionally -X- _ O
incorporating -X- _ O
correlation -X- _ B-MetricName
constraints -X- _ O
on -X- _ O
posterior -X- _ O
, -X- _ O
significant -X- _ O
performance -X- _ O
gains -X- _ O
would -X- _ O
be -X- _ O
obtained -X- _ O
, -X- _ O
especially -X- _ O
in -X- _ O
large -X- _ O
bits -X- _ O
scenarios -X- _ O
. -X- _ O

Effect -X- _ O
of -X- _ O
Spanning -X- _ O
Trees -X- _ O
For -X- _ O
more -X- _ O
efficient -X- _ O
training -X- _ O
, -X- _ O
spanning -X- _ O
trees -X- _ O
are -X- _ O
utilized -X- _ O
to -X- _ O
approximate -X- _ O
the -X- _ O
whole -X- _ O
graph -X- _ O
by -X- _ O
dropping -X- _ O
out -X- _ O
some -X- _ O
edges -X- _ O
. -X- _ O
To -X- _ O
understand -X- _ O
its -X- _ O
effects -X- _ O
, -X- _ O
we -X- _ O
first -X- _ O
investigate -X- _ O
the -X- _ O
impact -X- _ O
of -X- _ O
the -X- _ O
number -X- _ O
of -X- _ O
trees -X- _ O
. -X- _ O
The -X- _ O
first -X- _ O
row -X- _ O
of -X- _ O
Figure -X- _ O
2 -X- _ O
shows -X- _ O
the -X- _ O
performance -X- _ O
of -X- _ O
our -X- _ O
method -X- _ O
as -X- _ O
a -X- _ O
function -X- _ O
of -X- _ O
different -X- _ O
numbers -X- _ O
of -X- _ O
spanning -X- _ O
trees -X- _ O
. -X- _ O
We -X- _ O
observe -X- _ O
that -X- _ O
, -X- _ O
compared -X- _ O
to -X- _ O
not -X- _ O
using -X- _ O
any -X- _ O
correlation -X- _ B-MetricName
, -X- _ O
one -X- _ O
tree -X- _ O
alone -X- _ O
can -X- _ O
bring -X- _ O
significant -X- _ O
performance -X- _ O
gains -X- _ O
. -X- _ O
As -X- _ O
the -X- _ O
tree -X- _ O
number -X- _ O
increases -X- _ O
, -X- _ O
the -X- _ O
performance -X- _ O
rises -X- _ O
steadily -X- _ O
at -X- _ O
first -X- _ O
and -X- _ O
then -X- _ O
converges -X- _ O
into -X- _ O
a -X- _ O
certain -X- _ O
level -X- _ O
, -X- _ O
demonstrating -X- _ O
that -X- _ O
the -X- _ O
document -X- _ O
correlations -X- _ B-MetricName
can -X- _ O
be -X- _ O
mostly -X- _ O
captured -X- _ O
by -X- _ O
several -X- _ O
spanning -X- _ O
trees -X- _ O
. -X- _ O
Then -X- _ O
, -X- _ O
we -X- _ O
further -X- _ O
explore -X- _ O
the -X- _ O
impact -X- _ O
of -X- _ O
the -X- _ O
neighbor -X- _ O
number -X- _ O
when -X- _ O
constructing -X- _ O
the -X- _ O
graphs -X- _ O
using -X- _ O
the -X- _ O
KNN -X- _ O
method -X- _ O
, -X- _ O
as -X- _ O
shown -X- _ O
in -X- _ O
the -X- _ O
second -X- _ O
row -X- _ O
of -X- _ O
Figure -X- _ O
2 -X- _ O
. -X- _ O
It -X- _ O
can -X- _ O
be -X- _ O
seen -X- _ O
that -X- _ O
more -X- _ O
neighbors -X- _ O
contributes -X- _ O
to -X- _ O
better -X- _ O
performance -X- _ O
. -X- _ O
We -X- _ O
hypothesize -X- _ O
that -X- _ O
this -X- _ O
is -X- _ O
partly -X- _ O
due -X- _ O
to -X- _ O
the -X- _ O
more -X- _ O
diverse -X- _ O
correlation -X- _ B-MetricName
information -X- _ O
captured -X- _ O
by -X- _ O
the -X- _ O
increasing -X- _ O
number -X- _ O
of -X- _ O
neighbors -X- _ O
. -X- _ O
However -X- _ O
, -X- _ O
incorporating -X- _ O
too -X- _ O
many -X- _ O
neighbors -X- _ O
may -X- _ O
lead -X- _ O
to -X- _ O
the -X- _ O
problem -X- _ O
of -X- _ O
introducing -X- _ O
noise -X- _ O
and -X- _ O
incorrect -X- _ O
correlation -X- _ B-MetricName
information -X- _ O
to -X- _ O
the -X- _ O
hash -X- _ O
codes -X- _ O
. -X- _ O
That -X- _ O
explains -X- _ O
why -X- _ O
no -X- _ O
further -X- _ O
improvement -X- _ O
is -X- _ O
observed -X- _ O
after -X- _ O
the -X- _ O
number -X- _ O
reaches -X- _ O
a -X- _ O
level -X- _ O
. -X- _ O
VDSH -X- _ B-MethodName
in -X- _ O
2.038s -X- _ O
, -X- _ O
4.364s -X- _ O
, -X- _ O
1.051s -X- _ O
. -X- _ O
It -X- _ O
can -X- _ O
be -X- _ O
seen -X- _ O
that -X- _ O
our -X- _ O
model -X- _ O
, -X- _ O
though -X- _ O
with -X- _ O
much -X- _ O
stronger -X- _ O
performance -X- _ O
, -X- _ O
can -X- _ O
be -X- _ O
trained -X- _ O
almost -X- _ O
as -X- _ O
efficiently -X- _ O
as -X- _ O
vanilla -X- _ O
VDSH -X- _ B-MethodName
due -X- _ O
to -X- _ O
the -X- _ O
tree -X- _ O
approximations -X- _ O
. -X- _ O

Case -X- _ O
Study -X- _ O
In -X- _ O
Table -X- _ O
3 -X- _ O
, -X- _ O
we -X- _ O
present -X- _ O
a -X- _ O
retrieval -X- _ O
case -X- _ O
of -X- _ O
the -X- _ O
given -X- _ O
query -X- _ O
document -X- _ O
. -X- _ O
It -X- _ O
can -X- _ O
be -X- _ O
observed -X- _ O
that -X- _ O
as -X- _ O
the -X- _ O
Hamming -X- _ B-MetricName
distance -X- _ I-MetricName
increases -X- _ O
, -X- _ O
the -X- _ O
semantic -X- _ O
( -X- _ O
topic -X- _ O
) -X- _ O
of -X- _ O
the -X- _ O
retrieved -X- _ O
document -X- _ O
gradually -X- _ O
becomes -X- _ O
more -X- _ O
irrelevant -X- _ O
, -X- _ O
illustrating -X- _ O
that -X- _ O
the -X- _ O
Hamming -X- _ B-MetricName
distance -X- _ I-MetricName
can -X- _ O
effectively -X- _ O
measure -X- _ O
the -X- _ O
document -X- _ O
relevance -X- _ O
. -X- _ O

Visualization -X- _ O
of -X- _ O
Hash -X- _ O
Codes -X- _ O

To -X- _ O
evaluate -X- _ O
the -X- _ O
quality -X- _ O
of -X- _ O
generated -X- _ O
hash -X- _ O
code -X- _ O
more -X- _ O
intuitively -X- _ O
, -X- _ O
we -X- _ O
project -X- _ O
the -X- _ O
latent -X- _ O
representations -X- _ O
into -X- _ O
a -X- _ O
2dimensional -X- _ O
plane -X- _ O
with -X- _ O
the -X- _ O
t -X- _ O
- -X- _ O
SNE -X- _ O
( -X- _ O
van -X- _ O
der -X- _ O
Maaten -X- _ O
and -X- _ O
Hinton -X- _ O
, -X- _ O
2008 -X- _ O
) -X- _ O
technique -X- _ O
. -X- _ O
As -X- _ O
shown -X- _ O
in -X- _ O
Figure -X- _ O
3 -X- _ O
, -X- _ O
the -X- _ O
representations -X- _ O
generated -X- _ O
by -X- _ O
our -X- _ O
method -X- _ O
are -X- _ O
more -X- _ O
separable -X- _ O
than -X- _ O
those -X- _ O
of -X- _ O
AMMI -X- _ B-MethodName
, -X- _ O
demonstrating -X- _ O
the -X- _ O
superiority -X- _ O
of -X- _ O
our -X- _ O
method -X- _ O
. -X- _ O

Conclusion -X- _ O

We -X- _ O
have -X- _ O
proposed -X- _ O
an -X- _ O
effective -X- _ O
and -X- _ O
efficient -X- _ O
semantic -X- _ O
hashing -X- _ O
method -X- _ O
to -X- _ O
preserve -X- _ O
both -X- _ O
the -X- _ O
semantics -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
of -X- _ O
documents -X- _ O
. -X- _ O
Specifically -X- _ O
, -X- _ O
we -X- _ O
applied -X- _ O
a -X- _ O
graph -X- _ O
- -X- _ O
induced -X- _ O
Gaussian -X- _ O
prior -X- _ O
to -X- _ O
model -X- _ O
the -X- _ O
two -X- _ O
types -X- _ O
of -X- _ O
information -X- _ O
in -X- _ O
a -X- _ O
unified -X- _ O
framework -X- _ O
. -X- _ O
To -X- _ O
facilitate -X- _ O
training -X- _ O
, -X- _ O
a -X- _ O
treestructure -X- _ O
approximation -X- _ O
was -X- _ O
further -X- _ O
developed -X- _ O
to -X- _ O
decompose -X- _ O
the -X- _ O
ELBO -X- _ B-MetricName
into -X- _ O
terms -X- _ O
involving -X- _ O
only -X- _ O
singleton -X- _ O
or -X- _ O
pairwise -X- _ O
variables -X- _ O
. -X- _ O
Extensive -X- _ O
evaluations -X- _ O
demonstrated -X- _ O
that -X- _ O
our -X- _ O
model -X- _ O
significantly -X- _ O
outperforms -X- _ O
baseline -X- _ O
methods -X- _ O
by -X- _ O
incorporating -X- _ O
both -X- _ O
the -X- _ O
semantics -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
. -X- _ O

Appendices -X- _ O
A -X- _ O
Derivation -X- _ O
of -X- _ O
Formulas -X- _ O

Derivation -X- _ O
of -X- _ O
KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
||p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
) -X- _ O
In -X- _ O
the -X- _ O
main -X- _ O
paper -X- _ O
, -X- _ O
we -X- _ O
propose -X- _ O
a -X- _ O
tree -X- _ O
- -X- _ O
type -X- _ O
distribution -X- _ O
to -X- _ O
introduce -X- _ O
partial -X- _ O
neighborhood -X- _ O
information -X- _ O
so -X- _ O
that -X- _ O
the -X- _ O
L -X- _ O
2 -X- _ O
term -X- _ O
can -X- _ O
be -X- _ O
expressed -X- _ O
as -X- _ O
the -X- _ O
summation -X- _ O
over -X- _ O
terms -X- _ O
involving -X- _ O
only -X- _ O
one -X- _ O
or -X- _ O
two -X- _ O
variables -X- _ O
. -X- _ O

Here -X- _ O
, -X- _ O
we -X- _ O
provide -X- _ O
the -X- _ O
detail -X- _ O
derivation -X- _ O
. -X- _ O

KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
||p -X- _ O
T -X- _ O
( -X- _ O
Z -X- _ O
) -X- _ O
) -X- _ O
= -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
log -X- _ O
i∈V -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
i∈V -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
dZ -X- _ O
= -X- _ O
i∈V -X- _ O
KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
||p -X- _ O
θ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
) -X- _ O
− -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
E -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
log -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
. -X- _ O

Obviously -X- _ O
, -X- _ O
the -X- _ O
KL -X- _ B-MetricName
divergence -X- _ I-MetricName
is -X- _ O
decomposed -X- _ O
into -X- _ O
the -X- _ O
terms -X- _ O
involving -X- _ O
singleton -X- _ O
and -X- _ O
pairwise -X- _ O
variables -X- _ O
, -X- _ O
which -X- _ O
can -X- _ O
be -X- _ O
calculated -X- _ O
efficiently -X- _ O
. -X- _ O

Expressing -X- _ O
L -X- _ O
T -X- _ O
in -X- _ O
Analytical -X- _ O
Form -X- _ O
For -X- _ O
simplification -X- _ O
, -X- _ O
in -X- _ O
the -X- _ O
following -X- _ O
, -X- _ O
we -X- _ O
use -X- _ O
µ -X- _ O
1 -X- _ O
, -X- _ O
Σ -X- _ O
1 -X- _ O
to -X- _ O
represent -X- _ O
the -X- _ O
mean -X- _ O
and -X- _ O
variance -X- _ O
matrix -X- _ O
of -X- _ O
q -X- _ O
T -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
, -X- _ O
respectively -X- _ O
, -X- _ O
and -X- _ O
represent -X- _ O
those -X- _ O
of -X- _ O
p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
as -X- _ O
µ -X- _ O
2 -X- _ O
, -X- _ O
Σ -X- _ O
2 -X- _ O
, -X- _ O
respectively -X- _ O
. -X- _ O
Besides -X- _ O
we -X- _ O
denote -X- _ O
λa -X- _ B-HyperparameterName
ij -X- _ O
as -X- _ O
τ -X- _ O
ij -X- _ O
so -X- _ O
we -X- _ O
have -X- _ O
τ -X- _ O
ij -X- _ O
= -X- _ O
λa -X- _ B-HyperparameterName
ij -X- _ O
= -X- _ O
λa -X- _ B-HyperparameterName
ji -X- _ O
. -X- _ O
By -X- _ O
applying -X- _ O
the -X- _ O
Cholesky -X- _ O
decomposition -X- _ O
on -X- _ O
the -X- _ O
covariance -X- _ O
matrix -X- _ O
of -X- _ O
Σ -X- _ O
1 -X- _ O
and -X- _ O
Σ -X- _ O
2 -X- _ O

Σ -X- _ O
1 -X- _ O
= -X- _ O
σ -X- _ O
i -X- _ O
0 -X- _ O
d -X- _ O
γ -X- _ O
ij -X- _ O
σ -X- _ O
j -X- _ O
1 -X- _ O
− -X- _ O
γ -X- _ O
2 -X- _ O
ij -X- _ O
σ -X- _ O
j -X- _ O
σ -X- _ O
i -X- _ O
γ -X- _ O
ij -X- _ O
σ -X- _ O
j -X- _ O
0 -X- _ O
d -X- _ O
1 -X- _ O
− -X- _ O
γ -X- _ O
2 -X- _ O
ij -X- _ O
σ -X- _ O
j -X- _ O
, -X- _ O
Σ -X- _ O
2 -X- _ O
= -X- _ O
I -X- _ O
d -X- _ O
0 -X- _ O
τ -X- _ O
ij -X- _ O
I -X- _ O
d -X- _ O
1 -X- _ O
− -X- _ O
τ -X- _ O
2 -X- _ O
ij -X- _ O
I -X- _ O
d -X- _ O
I -X- _ O
d -X- _ O
τ -X- _ O
ij -X- _ O
I -X- _ O
d -X- _ O
0 -X- _ O
1 -X- _ O
− -X- _ O
τ -X- _ O
2 -X- _ O
ij -X- _ O
I -X- _ O
d -X- _ O
, -X- _ O

where -X- _ O
we -X- _ O
omit -X- _ O
diag -X- _ O
( -X- _ O
• -X- _ O
) -X- _ O
for -X- _ O
simplifying -X- _ O
, -X- _ O
we -X- _ O
have -X- _ O

KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
) -X- _ O
= -X- _ O
1 -X- _ O
2 -X- _ O
d -X- _ O
n=1 -X- _ O
log -X- _ O
( -X- _ O
1 -X- _ O
− -X- _ O
τ -X- _ O
2 -X- _ O
ij -X- _ O
) -X- _ O
− -X- _ O
log -X- _ O
σ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
log -X- _ O
σ -X- _ O
2 -X- _ O
jn -X- _ O
+ -X- _ O
log -X- _ O
( -X- _ O
1 -X- _ O
− -X- _ O
γ -X- _ O
2 -X- _ O
ijn -X- _ O
) -X- _ O
− -X- _ O
2 -X- _ O
+ -X- _ O
σ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
σ -X- _ O
2 -X- _ O
jn -X- _ O
−2τ -X- _ O
ij -X- _ O
γ -X- _ O
ijn -X- _ O
σ -X- _ O
in -X- _ O
σ -X- _ O
jn -X- _ O
+ -X- _ O
µ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
µ -X- _ O
jn -X- _ O
−2τ -X- _ O
ij -X- _ O
µ -X- _ O
in -X- _ O
µ -X- _ O
jn -X- _ O
1 -X- _ O
− -X- _ O
τ -X- _ O
2 -X- _ O
ij -X- _ O
. -X- _ O

Algorithm -X- _ O
1 -X- _ O
Model -X- _ O
Training -X- _ O
Algorithm -X- _ O

Input -X- _ O
: -X- _ O
Document -X- _ O
representations -X- _ O
X -X- _ O
; -X- _ O
edges -X- _ O
list -X- _ O
of -X- _ O
spanning -X- _ O
trees -X- _ O
E -X- _ O
; -X- _ O
batch -X- _ B-HyperparameterName
size -X- _ I-HyperparameterName
b. -X- _ B-HyperparameterName
Output -X- _ O
: -X- _ O
Optimal -X- _ O
parameters -X- _ O
( -X- _ O
θ -X- _ O
, -X- _ O
φ -X- _ O
) -X- _ O
. -X- _ O

1 -X- _ O
: -X- _ O
θ -X- _ O
, -X- _ O
φ -X- _ O
← -X- _ O
Initialize -X- _ O
parameters -X- _ O
2 -X- _ O
: -X- _ O
repeat -X- _ O
3 -X- _ O
: -X- _ O

V -X- _ O
M -X- _ O
← -X- _ O
{ -X- _ O
x1 -X- _ O
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
x -X- _ O
b -X- _ O
} -X- _ O
∼ -X- _ O
X -X- _ O
Sample -X- _ O
nodes -X- _ O
4 -X- _ O
: -X- _ O
E -X- _ O
M -X- _ O
T -X- _ O
← -X- _ O
{ -X- _ O
e1 -X- _ O
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
e -X- _ O
b -X- _ O
} -X- _ O
∼ -X- _ O
E -X- _ O
Sample -X- _ O
endges -X- _ O
5 -X- _ O
: -X- _ O
g -X- _ O
← -X- _ O
∇ -X- _ O
φ -X- _ O
, -X- _ O
θ -X- _ O
L -X- _ O
M -X- _ O
MT -X- _ O
( -X- _ O
θ -X- _ O
, -X- _ O
φ -X- _ O
; -X- _ O
V -X- _ O
M -X- _ O
, -X- _ O
E -X- _ O
M -X- _ O
T -X- _ O
) -X- _ O
6 -X- _ O
: -X- _ O

θ -X- _ O
, -X- _ O
φ -X- _ O
← -X- _ O
Update -X- _ O
parameters -X- _ O
using -X- _ O
gradients -X- _ O
g -X- _ O
( -X- _ O
e.g. -X- _ O
, -X- _ O
Adam -X- _ O
optimizer -X- _ O
) -X- _ O
7 -X- _ O
: -X- _ O
until -X- _ O
convergence -X- _ O
of -X- _ O
parameters -X- _ O
( -X- _ O
θ -X- _ O
, -X- _ O
φ -X- _ O
) -X- _ O
Then -X- _ O
, -X- _ O
we -X- _ O
can -X- _ O
express -X- _ O
L -X- _ O
T -X- _ O
in -X- _ O
an -X- _ O
analytical -X- _ O
form -X- _ O

Input -X- _ O
document -X- _ O
pair -X- _ O
( -X- _ O
xi -X- _ O
; -X- _ O
xj -X- _ O
) -X- _ O
Variational -X- _ O
Enc -X- _ O
Correlated -X- _ O
Enc -X- _ O
Encoder -X- _ O
Linear -X- _ O
( -X- _ O
|V -X- _ O
| -X- _ O
, -X- _ O
d -X- _ O
) -X- _ O
Linear -X- _ O
( -X- _ O
|V -X- _ O
| -X- _ O
, -X- _ O
d -X- _ O
) -X- _ O
Linear -X- _ O
( -X- _ O
2|V -X- _ O
| -X- _ O
, -X- _ O
d -X- _ O
) -X- _ O
µ -X- _ O
= -X- _ O
f -X- _ O
( -X- _ O
• -X- _ O
/ -X- _ O
τ -X- _ O
) -X- _ O
σ -X- _ O
= -X- _ O
g -X- _ O
( -X- _ O
• -X- _ O
) -X- _ O
γ -X- _ O
= -X- _ O
2 -X- _ O
* -X- _ O
f -X- _ O
( -X- _ O
• -X- _ O
) -X- _ O
− -X- _ O
1 -X- _ O
Generator -X- _ O
Linear -X- _ O
( -X- _ O
d -X- _ O
, -X- _ O
|V -X- _ O
| -X- _ O
) -X- _ O

L -X- _ O
T -X- _ O
= -X- _ O
i∈V -X- _ O
E -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
[ -X- _ O
log -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
|z -X- _ O
i -X- _ O
) -X- _ O
] -X- _ O
− -X- _ O
1 -X- _ O
2 -X- _ O
d -X- _ O
n=1 -X- _ O
( -X- _ O
µ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
σ -X- _ O
2 -X- _ O
in -X- _ O
−1−2 -X- _ O
log -X- _ O
σ -X- _ O
in -X- _ O
) -X- _ O
− -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
1 -X- _ O
2 -X- _ O
d -X- _ O
n=1 -X- _ O
log -X- _ O
( -X- _ O
1 -X- _ O
− -X- _ O
τ -X- _ O
2 -X- _ O
ij -X- _ O
) -X- _ O
− -X- _ O
µ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
µ -X- _ O
2 -X- _ O
jn -X- _ O
+ -X- _ O
σ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
σ -X- _ O
2 -X- _ O
jn -X- _ O
+ -X- _ O
log -X- _ O
( -X- _ O
1 -X- _ O
− -X- _ O
γ -X- _ O
2 -X- _ O
ijn -X- _ O
) -X- _ O
+ -X- _ O
σ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
σ -X- _ O
2 -X- _ O
jn -X- _ O
−2τ -X- _ O
ij -X- _ O
γ -X- _ O
ijn -X- _ O
σ -X- _ O
in -X- _ O
σ -X- _ O
jn -X- _ O
+ -X- _ O
µ -X- _ O
2 -X- _ O
in -X- _ O
+ -X- _ O
µ -X- _ O
jn -X- _ O
−2τ -X- _ O
ij -X- _ O
µ -X- _ O
in -X- _ O
µ -X- _ O
jn -X- _ O
1 -X- _ O
− -X- _ O
τ -X- _ O
2 -X- _ O
ij -X- _ O

Derivation -X- _ O
of -X- _ O
L -X- _ O
MT -X- _ O
With -X- _ O
L -X- _ O
MT -X- _ O
, -X- _ O
we -X- _ O
extend -X- _ O
the -X- _ O
single -X- _ O
- -X- _ O
tree -X- _ O
approximation -X- _ O
to -X- _ O
multi -X- _ O
- -X- _ O
tree -X- _ O
approximation -X- _ O
. -X- _ O
Although -X- _ O
the -X- _ O
KL -X- _ B-MetricName
divergence -X- _ I-MetricName
between -X- _ O
the -X- _ O
mixture -X- _ O
distributions -X- _ O
does -X- _ O
not -X- _ O
have -X- _ O
a -X- _ O
closed -X- _ O
- -X- _ O
form -X- _ O
solution -X- _ O
, -X- _ O
we -X- _ O
can -X- _ O
obtain -X- _ O
its -X- _ O
explicit -X- _ O
upper -X- _ O
bound -X- _ O
by -X- _ O
using -X- _ O
the -X- _ O
log -X- _ O
- -X- _ O
sum -X- _ O
inequality -X- _ O
as -X- _ O

L -X- _ O
MT -X- _ O
≥ -X- _ O
1 -X- _ O
M -X- _ O
T -X- _ O
∈T -X- _ O
G -X- _ O
E -X- _ O
q -X- _ O
T -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
[ -X- _ O
log -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
X|Z -X- _ O
) -X- _ O
] -X- _ O
− -X- _ O
1 -X- _ O
M -X- _ O
T -X- _ O
∈T -X- _ O
G -X- _ O
KL -X- _ O
( -X- _ O
q -X- _ O
T -X- _ O
( -X- _ O
Z|X -X- _ O
) -X- _ O
||p -X- _ O
T -X- _ O
( -X- _ O
X -X- _ O
) -X- _ O
) -X- _ O
L -X- _ O
MT -X- _ O
. -X- _ O

We -X- _ O
can -X- _ O
further -X- _ O
express -X- _ O
L -X- _ O
MT -X- _ O
in -X- _ O
a -X- _ O
more -X- _ O
intuitive -X- _ O
form -X- _ O
as -X- _ O
where -X- _ O
w -X- _ O
ij -X- _ O
= -X- _ O
| -X- _ O
{ -X- _ O
T -X- _ O
∈T -X- _ O
G -X- _ O
| -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
} -X- _ O
| -X- _ O
M -X- _ O
denotes -X- _ O
the -X- _ O
proportion -X- _ O
of -X- _ O
times -X- _ O
that -X- _ O
the -X- _ O
edge -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
appears -X- _ O
. -X- _ O
To -X- _ O
optimize -X- _ O
this -X- _ O
objective -X- _ O
, -X- _ O
we -X- _ O
can -X- _ O
construct -X- _ O
an -X- _ O
estimator -X- _ O
of -X- _ O
the -X- _ O
ELBO -X- _ B-MetricName
, -X- _ O
based -X- _ O
on -X- _ O
the -X- _ O
minibatch -X- _ O

i∈V -X- _ O
E -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
[ -X- _ O
log -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
|z -X- _ O
i -X- _ O
) -X- _ O
] -X- _ O
−KL -X- _ O
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
) -X- _ O
− -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
T -X- _ O
w -X- _ O
ij -X- _ O
KL -X- _ O
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
) -X- _ O
−KL -X- _ O
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
) -X- _ O
−KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
j -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
) -X- _ O
, -X- _ O

L -X- _ O
MT -X- _ O
L -X- _ O
M -X- _ O
MT -X- _ O
= -X- _ O
i∈V -X- _ O
M -X- _ O
L -X- _ O
V -X- _ O
M -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
− -X- _ O
( -X- _ O
i -X- _ O
, -X- _ O
j -X- _ O
) -X- _ O
∈E -X- _ O
M -X- _ O
T -X- _ O
w -X- _ O
ij -X- _ O
L -X- _ O
E -X- _ O
M -X- _ O
T -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
, -X- _ O

where -X- _ O
V -X- _ O
M -X- _ O
is -X- _ O
the -X- _ O
subset -X- _ O
of -X- _ O
documents -X- _ O
, -X- _ O
E -X- _ O
M -X- _ O
T -X- _ O
is -X- _ O
the -X- _ O
subset -X- _ O
of -X- _ O
edges -X- _ O
and -X- _ O

L -X- _ O
V -X- _ O
M -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
E -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
[ -X- _ O
log -X- _ O
p -X- _ O
θ -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
|z -X- _ O
i -X- _ O
) -X- _ O
] -X- _ O
− -X- _ O
KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
) -X- _ O
; -X- _ O
L -X- _ O
E -X- _ O
M -X- _ O
T -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
, -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
x -X- _ O
i -X- _ O
, -X- _ O
x -X- _ O
j -X- _ O
) -X- _ O
) -X- _ O
−KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
|x -X- _ O
i -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
i -X- _ O
) -X- _ O
) -X- _ O
−KL -X- _ B-MetricName
( -X- _ O
q -X- _ O
φ -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
|x -X- _ O
j -X- _ O
) -X- _ O
||p -X- _ O
G -X- _ O
( -X- _ O
z -X- _ O
j -X- _ O
) -X- _ O
) -X- _ O
. -X- _ O

Then -X- _ O
we -X- _ O
can -X- _ O
update -X- _ O
the -X- _ O
parameters -X- _ O
by -X- _ O
using -X- _ O
the -X- _ O
gradient -X- _ O
∇ -X- _ O
φ -X- _ O
, -X- _ O
θ -X- _ O
L -X- _ O
M -X- _ O
MT -X- _ O
. -X- _ O
The -X- _ O
training -X- _ O
procedure -X- _ O
is -X- _ O
summarized -X- _ O
in -X- _ O
Algorithm -X- _ O
1 -X- _ O
. -X- _ O

B -X- _ O
Tree -X- _ O
Generation -X- _ O
Algorithm -X- _ O

Algorithm -X- _ O
2 -X- _ O
shows -X- _ O
the -X- _ O
spanning -X- _ O
tree -X- _ O
generation -X- _ O
algorithm -X- _ O
TreeGen -X- _ O
( -X- _ O
• -X- _ O
) -X- _ O
used -X- _ O
in -X- _ O
our -X- _ O
graph -X- _ O
- -X- _ O
induced -X- _ O
generative -X- _ O
document -X- _ O
hashing -X- _ O
model -X- _ O
. -X- _ O
TreeGen -X- _ O
( -X- _ O
• -X- _ O
) -X- _ O
utilizes -X- _ O
a -X- _ O
depth -X- _ O
- -X- _ O
first -X- _ O
search -X- _ O
( -X- _ O
DFS -X- _ O
) -X- _ O
algorithm -X- _ O
to -X- _ O
generate -X- _ O
meaningful -X- _ O
neighborhood -X- _ O
information -X- _ O
for -X- _ O
each -X- _ O
node -X- _ O
. -X- _ O
In -X- _ O
this -X- _ O
algorithm -X- _ O
, -X- _ O
RC -X- _ O
[ -X- _ O
• -X- _ O
] -X- _ O
means -X- _ O
randomly -X- _ O
choosing -X- _ O
one -X- _ O
index -X- _ O
according -X- _ O
to -X- _ O
the -X- _ O
indicator -X- _ O
function -X- _ O
; -X- _ O
ID -X- _ O
[ -X- _ O
• -X- _ O
] -X- _ O
represents -X- _ O
the -X- _ O
set -X- _ O
of -X- _ O
node -X- _ O
indexes -X- _ O
satisfying -X- _ O
the -X- _ O
indicator -X- _ O
condition -X- _ O
and -X- _ O
N -X- _ O
( -X- _ O
i -X- _ O
) -X- _ O
denotes -X- _ O
the -X- _ O
neighbors -X- _ O
of -X- _ O
node -X- _ O
i. -X- _ O
Due -X- _ O
to -X- _ O
the -X- _ O
importance -X- _ O
of -X- _ O
edges -X- _ O
precision -X- _ O
, -X- _ O
when -X- _ O
choosing -X- _ O
a -X- _ O
neighbor -X- _ O
( -X- _ O
line -X- _ O
16 -X- _ O
in -X- _ O
Algorithm -X- _ O
2 -X- _ O
) -X- _ O
, -X- _ O
instead -X- _ O
of -X- _ O
using -X- _ O
uniform -X- _ O
sampling -X- _ O
, -X- _ O
we -X- _ O
exploit -X- _ O
a -X- _ O
temperature -X- _ O
α -X- _ O
to -X- _ O
control -X- _ O
the -X- _ O
trade -X- _ O
- -X- _ O
off -X- _ O
between -X- _ O
the -X- _ O
precision -X- _ O
and -X- _ O
diversity -X- _ O
of -X- _ O
edges -X- _ O
. -X- _ O
Specifically -X- _ O
, -X- _ O
the -X- _ O
probability -X- _ O
of -X- _ O
sampling -X- _ O
neighbor -X- _ O
j -X- _ O
of -X- _ O
node -X- _ O
i -X- _ O
is -X- _ O
exp -X- _ O
( -X- _ O
cos -X- _ O
( -X- _ O
x -X- _ O
T -X- _ O
j -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
/ -X- _ O
α -X- _ O
) -X- _ O
n∈N -X- _ O
( -X- _ O
i -X- _ O
) -X- _ O
exp -X- _ O
( -X- _ O
cos -X- _ O
( -X- _ O
x -X- _ O
T -X- _ O
n -X- _ O
x -X- _ O
i -X- _ O
) -X- _ O
/ -X- _ O
α -X- _ O
) -X- _ O

. -X- _ O

We -X- _ O
find -X- _ O
the -X- _ O
best -X- _ O
configuration -X- _ O
of -X- _ O
α -X- _ B-HyperparameterName
on -X- _ O
the -X- _ O
validation -X- _ O
set -X- _ O
with -X- _ O
the -X- _ O
values -X- _ O
in -X- _ O
{ -X- _ O
0.1 -X- _ B-HyperparameterValue
, -X- _ O
0.2 -X- _ B-HyperparameterValue
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
1 -X- _ B-HyperparameterValue
} -X- _ O
. -X- _ O

C -X- _ O
Experiment -X- _ O
Details -X- _ O

For -X- _ O
fair -X- _ O
comparisons -X- _ O
, -X- _ O
we -X- _ O
follow -X- _ O
the -X- _ O
experimental -X- _ O
setting -X- _ O
of -X- _ O
VDSH -X- _ B-MethodName
. -X- _ O
Specifically -X- _ O
, -X- _ O
the -X- _ O
vocabulary -X- _ B-HyperparameterName
size -X- _ I-HyperparameterName
|V -X- _ B-HyperparameterName
| -X- _ I-HyperparameterName
is -X- _ O
7164 -X- _ B-HyperparameterValue
, -X- _ O
20000 -X- _ B-HyperparameterValue
, -X- _ O
and -X- _ O
10000 -X- _ B-HyperparameterValue
for -X- _ O
Reuters -X- _ B-DatasetName
, -X- _ O
TMC -X- _ B-DatasetName
and -X- _ O
20Newsgroups -X- _ B-DatasetName
, -X- _ O
respectively -X- _ O
. -X- _ O
The -X- _ O
split -X- _ B-HyperparameterName
of -X- _ O
training -X- _ O
, -X- _ O
validation -X- _ O
, -X- _ O
and -X- _ O
test -X- _ O
set -X- _ O
is -X- _ O
as -X- _ O
follows -X- _ O
: -X- _ O
7752 -X- _ B-HyperparameterValue
, -X- _ O
967 -X- _ B-HyperparameterValue
, -X- _ O
964 -X- _ B-HyperparameterValue
for -X- _ O
Reuters -X- _ B-DatasetName
; -X- _ O
21286 -X- _ B-HyperparameterValue
, -X- _ O
3498 -X- _ B-HyperparameterValue
, -X- _ O
3498 -X- _ B-HyperparameterValue
for -X- _ O
TMC -X- _ B-DatasetName
and -X- _ O
11016 -X- _ B-HyperparameterValue
, -X- _ O
3667 -X- _ B-HyperparameterValue
, -X- _ O
3668 -X- _ B-HyperparameterValue
for -X- _ O
20Newsgroups -X- _ B-DatasetName
, -X- _ O
respectively -X- _ O
. -X- _ O
Moreover -X- _ O
, -X- _ O
the -X- _ O
KL -X- _ B-MetricName
term -X- _ O
in -X- _ O
Eq -X- _ O
. -X- _ O
( -X- _ O
18 -X- _ O
) -X- _ O
of -X- _ O
the -X- _ O
main -X- _ O
paper -X- _ O
is -X- _ O
weighted -X- _ O
with -X- _ O
a -X- _ O
coefficient -X- _ O
β -X- _ B-HyperparameterName
to -X- _ O
avoid -X- _ O
posterior -X- _ O
collapse -X- _ O
. -X- _ O
We -X- _ O
find -X- _ O
the -X- _ O
best -X- _ O
configuration -X- _ O
of -X- _ O
β -X- _ B-HyperparameterName
on -X- _ O
the -X- _ O
validation -X- _ O
set -X- _ O
with -X- _ O
the -X- _ O
values -X- _ O
in -X- _ O
{ -X- _ O
0.01 -X- _ B-HyperparameterValue
, -X- _ O
0.02 -X- _ B-HyperparameterValue
, -X- _ O
• -X- _ O
• -X- _ O
• -X- _ O
, -X- _ O
0.1 -X- _ B-HyperparameterValue
} -X- _ O
. -X- _ O
To -X- _ O
intuitively -X- _ O
understand -X- _ O
our -X- _ O
model -X- _ O
, -X- _ O
we -X- _ O
illustrate -X- _ O
the -X- _ O
whole -X- _ O
architecture -X- _ O
in -X- _ O
Table -X- _ O
4 -X- _ O
. -X- _ O

D -X- _ O
Additional -X- _ O
Experiments -X- _ O

Comparing -X- _ O
with -X- _ O
RBSH -X- _ B-MethodName
and -X- _ O
PairRec -X- _ B-MethodName
As -X- _ O
mentioned -X- _ O
before -X- _ O
, -X- _ O
the -X- _ O
reason -X- _ O
we -X- _ O
do -X- _ O
not -X- _ O
directly -X- _ O
compare -X- _ O
our -X- _ O
method -X- _ O
with -X- _ O
RBSH -X- _ B-MethodName
( -X- _ O
Hansen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2019 -X- _ O
) -X- _ O
and -X- _ O
PairRec -X- _ B-MethodName
( -X- _ O
Hansen -X- _ O
et -X- _ O
al -X- _ O
. -X- _ O
, -X- _ O
2020 -X- _ O
) -X- _ O
is -X- _ O
that -X- _ O
their -X- _ O
data -X- _ O
processing -X- _ O
methods -X- _ O
are -X- _ O
different -X- _ O
from -X- _ O
the -X- _ O
mainstream -X- _ O
methods -X- _ O
( -X- _ O
e.g. -X- _ O
, -X- _ O
VDSH -X- _ B-MethodName
, -X- _ O
NASH -X- _ B-MethodName
, -X- _ O
GMSH -X- _ B-MethodName
, -X- _ O
Nbr -X- _ B-MethodName
- -X- _ I-MethodName
Reg -X- _ I-MethodName
, -X- _ O
AMMI -X- _ B-MethodName
and -X- _ O
CorrSH -X- _ B-MethodName
) -X- _ O
. -X- _ O
To -X- _ O
further -X- _ O
compare -X- _ O
our -X- _ O
method -X- _ O
with -X- _ O
them -X- _ O
, -X- _ O
we -X- _ O
evaluate -X- _ O
our -X- _ O
model -X- _ O
on -X- _ O
three -X- _ O
datasets -X- _ O
that -X- _ O
are -X- _ O
published -X- _ O
by -X- _ O
RBSH -X- _ B-MethodName
4 -X- _ O
. -X- _ O
The -X- _ O
results -X- _ O
are -X- _ O
illustrated -X- _ O
in -X- _ O
Table -X- _ O
5 -X- _ O
. -X- _ O
We -X- _ O
observe -X- _ O
that -X- _ O
our -X- _ O
method -X- _ O
achieves -X- _ O
the -X- _ O
best -X- _ O
performances -X- _ O
in -X- _ O
most -X- _ O
experimental -X- _ O
settings -X- _ O
, -X- _ O
which -X- _ O
further -X- _ O
confirms -X- _ O
the -X- _ O
superiority -X- _ O
of -X- _ O
simultaneously -X- _ O
preserving -X- _ O
the -X- _ O
semantics -X- _ O
and -X- _ O
similarity -X- _ O
information -X- _ O
in -X- _ O
a -X- _ O
more -X- _ O
principled -X- _ O
framework -X- _ O
. -X- _ O

Parameter -X- _ O
Sensitivity -X- _ O
To -X- _ O
understand -X- _ O
the -X- _ O
robustness -X- _ O
of -X- _ O
our -X- _ O
model -X- _ O
, -X- _ O
we -X- _ O
conduct -X- _ O
a -X- _ O
parameter -X- _ O
Sensitivity -X- _ O
analysis -X- _ O
of -X- _ O
τ -X- _ B-HyperparameterName
and -X- _ O
β -X- _ B-HyperparameterName
in -X- _ O
Figure -X- _ O
4 -X- _ O
. -X- _ O
Compared -X- _ O
with -X- _ O
β -X- _ B-HyperparameterName
= -X- _ O
0 -X- _ B-HyperparameterValue
( -X- _ O
without -X- _ O
using -X- _ O
neighborhood -X- _ O
information -X- _ O
) -X- _ O
, -X- _ O
models -X- _ O
with -X- _ O
β -X- _ B-HyperparameterName
= -X- _ O
0 -X- _ B-HyperparameterValue
improve -X- _ O
performance -X- _ O
significantly -X- _ O
, -X- _ O
but -X- _ O
gradually -X- _ O
performs -X- _ O
steadily -X- _ O
as -X- _ O
β -X- _ B-HyperparameterName
getting -X- _ O
larger -X- _ O
, -X- _ O
which -X- _ O
once -X- _ O
again -X- _ O
confirms -X- _ O
the -X- _ O
importance -X- _ O
of -X- _ O
simultaneously -X- _ O
modeling -X- _ O
semantic -X- _ O
and -X- _ O
neighborhood -X- _ O
information -X- _ O
. -X- _ O
As -X- _ O
for -X- _ O
temperature -X- _ B-HyperparameterName
coefficient -X- _ I-HyperparameterName
τ -X- _ B-HyperparameterName
used -X- _ O
in -X- _ O
variational -X- _ O
encoder -X- _ O
, -X- _ O
our -X- _ O
model -X- _ O
performs -X- _ O
steadily -X- _ O
with -X- _ O
various -X- _ O
values -X- _ O
of -X- _ O
τ -X- _ B-HyperparameterName
in -X- _ O
the -X- _ O
Reuters -X- _ B-DatasetName
dataset -X- _ O
. -X- _ O
But -X- _ O
in -X- _ O
TMC -X- _ B-DatasetName
and -X- _ O
20Newsgroups -X- _ B-DatasetName
, -X- _ O
increasing -X- _ O
τ -X- _ B-HyperparameterName
would -X- _ O
deteriorate -X- _ O
the -X- _ O
model -X- _ O
performance -X- _ O
. -X- _ O
Generally -X- _ O
speaking -X- _ O
, -X- _ O
the -X- _ O
model -X- _ O
can -X- _ O
achieve -X- _ O
better -X- _ O
performance -X- _ O
with -X- _ O
smaller -X- _ O
τ -X- _ B-HyperparameterName
( -X- _ O
i.e. -X- _ O
, -X- _ O
steeper -X- _ O
sigmoid -X- _ O
function -X- _ O
) -X- _ O
. -X- _ O
As -X- _ O
we -X- _ O
utilize -X- _ O
0.5 -X- _ B-HyperparameterValue
as -X- _ O
the -X- _ O
threshold -X- _ O
value -X- _ O
, -X- _ O
steeper -X- _ O
sigmoid -X- _ O
functions -X- _ O
make -X- _ O
it -X- _ O
easier -X- _ O
to -X- _ O
distinguish -X- _ O
hash -X- _ O
codes -X- _ O
. -X- _ O

Acknowledgements -X- _ O

This -X- _ O
work -X- _ O
is -X- _ O
supported -X- _ O
by -X- _ O
the -X- _ O
National -X- _ O
Natural -X- _ O
Science -X- _ O
Foundation -X- _ O
of -X- _ O
China -X- _ O
( -X- _ O
No -X- _ O
. -X- _ O
61806223 -X- _ O
, -X- _ O
61906217 -X- _ O
, -X- _ O
U1811264 -X- _ O
) -X- _ O
, -X- _ O
Key -X- _ O
R -X- _ O
& -X- _ O
D -X- _ O
Program -X- _ O
of -X- _ O
Guangdong -X- _ O
Province -X- _ O
( -X- _ O
No -X- _ O
. -X- _ O
2018B010107005 -X- _ O
) -X- _ O
, -X- _ O
National -X- _ O
Natural -X- _ O
Science -X- _ O
Foundation -X- _ O
of -X- _ O
Guangdong -X- _ O
Province -X- _ O
( -X- _ O
No -X- _ O
. -X- _ O
2021A1515012299 -X- _ O
) -X- _ O
. -X- _ O
This -X- _ O
work -X- _ O
is -X- _ O
also -X- _ O
supported -X- _ O
by -X- _ O
MindSpore -X- _ O
. -X- _ O

